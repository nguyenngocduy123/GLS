webpackJsonp([26],{101:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var o=n(2),i=(n(24),function(e){function t(t,n){var o=e.call(this,{platform:n})||this;return o.loadingCtrl=t,o.platform=n,o}return Object(o.__extends)(t,e),t.prototype.show=function(e){var t=this;void 0===e&&(e="Please wait");var n=this.loadingCtrl.create({content:e+"..."}),o=function(){};return n.willEnter.subscribe(function(){return o=t.overwriteBackBtnEvent()}),n.onDidDismiss(function(){return o()}),n.present(),n},t}(n(152).a))},152:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var o=n(24),i=n(28),r=n(25),a=function(){function e(e){this.navOptions={animate:!1,updateUrl:!1},this.app=e.app,this.platform=e.platform,Object(i.c)(e.navCtrl,"parent")?this.tabsNav=e.navCtrl.parent:this.rootNav=e.navCtrl}return e.prototype.goPage=function(e,t){void 0===t&&(t={}),!0===this.canNavigate()&&this.rootNav.push(e,t,this.navOptions)},e.prototype.goPreviousPage=function(e){void 0===e&&(e=0),!0===this.canNavigate()&&(0===e?this.rootNav.pop(this.navOptions):this.rootNav.popTo(this.rootNav.getByIndex(this.rootNav.length()-e),this.navOptions))},e.prototype.goHomePage=function(e){void 0===e&&(e={}),!0===this.canNavigate()&&(console.log("[NAVIGATION] Going to "+r.a.home.page),this.rootNav.setRoot(r.a.home.page,e,this.navOptions))},e.prototype.goLoginPage=function(e){void 0===e&&(e={}),!0===this.canNavigate()&&(console.log("[NAVIGATION] Going to "+r.a.login.page),this.rootNav.setRoot(r.a.login.page,e,this.navOptions))},e.prototype.exitApp=function(){this.platform.exitApp()},e.prototype.overwriteBackBtnEvent=function(e){return void 0===e&&(e=function(){}),this.platform?this.platform.registerBackButtonAction(e,10):(console.log("[WARN] platform is not initialised. Failed to disable back button."),function(){})},e.prototype.goNextTab=function(){if(this.tabsNav instanceof o.a){var e=this.tabsNav.getByIndex(this.tabsNav.getSelected().index+1);if(e&&e.show)return e.enabled=!0,this.tabsNav.select(e,this.navOptions),!0}else console.log("[WARN] There is no tab to navigate to. Failed to go next tab.");return!1},e.prototype.canNavigate=function(){return!this.rootNav&&Object(i.c)(this.app,"getRootNav")&&(this.rootNav=this.app.getRootNav()),!!this.rootNav},e}()},161:function(e,t,n){"use strict";n.d(t,"a",function(){return s});n(2),n(151);var o=n(28),i=(n(24),n(70)),r=n(339),a=(n(74),n(75),n(49),function(){var e={};return e[e.Success=0]="Success",e[e.Fail=1]="Fail",e}()),s=function(){function e(e,t,n,o,i){this.base64=e,this.diagnostic=t,this.driver=n,this.geolocation=o,this.modalCtrl=i,this.inputByBarcode=!1,this.items=[],this.notePhotos=[],this.verified=!1,this.podSignatureData=[]}return e.prototype.initItems=function(e){var t=this;void 0===e&&(e=!1);var n=this.getDetails(),o=!1;!0!==e&&0!==this.items.length||(this.inputByBarcode=!1,o=!0),this.items=n.DeliveryItems.map(function(e){var n=e.Id,i=e.ItemId,r=e.ItemQty,a=e.ActualItemQty,s=a,u=[];if(!1===o){var c=t.items.find(function(e){return e.name===i});u=c?c.scanned:[],s=c?c.actual:a}return{id:n,name:i,expected:r,actual:s,scanned:u}})},e.prototype.initNotes=function(e){if(void 0===e&&(e=!1),!0===e||!this.noteOption&&!this.noteText){var t=this.getDetails();if(t.NoteFromDriver.length>0){var n=t.NoteFromDriver.find(function(e){return e.key===r.a.Option});this.noteOption=Object(o.c)(n,"value");var i=t.NoteFromDriver.find(function(e){return e.key===r.a.FreeText});this.noteText=Object(o.c)(i,"value")}this.notePhotos=[]}},e.prototype.getDetails=function(){var e=this;if(void 0!==this.id)return this.driver.jobs.find(function(t){return t.Id===e.id})},e.prototype.setSuccess=function(e){this.id=e,this.action=this.action?this.action:a.Success},e.prototype.setFail=function(e){this.id=e,this.action=this.action?this.action:a.Fail},e.prototype.isSuccess=function(){return this.action===a.Success},e.prototype.complete=function(){var e=this,t=this.getDetails();return!1===this.isItemsValid(t)?Promise.reject("invalid_items"):!1===this.driver.isPreviousJobComplete(t)?Promise.reject("Please ensure the previous pickup job has been completed first."):this.diagnostic.hasLocationPermission().then(function(t){return!0===t?e.constructRequest():new Promise(function(t,n){var o=e.modalCtrl.create("AppPermissionPage",{},{enableBackdropDismiss:!1});o.onDidDismiss(function(){return e.constructRequest().then(t).catch(n)}),o.present()})}).then(function(t){return e.driver.jobAttempt(t)}).then(function(){return e.reset()})},e.prototype.reset=function(){this.id=void 0,this.action=void 0,this.inputByBarcode=!1,this.items=[],this.noteOption=void 0,this.noteText=void 0,this.notePhotos=[],this.verified=!1,this.podSignature=void 0,this.podSignatureData=[],this.podPhoto=void 0},e.prototype.constructRequest=function(){var e=this;return console.log("[ATTEMPT] Getting location"),Promise.all([this.convertPhotosToBase64(),this.geolocation.getCurrentLocation().catch(function(){})]).then(function(t){var n=t[0],a=t[1];console.log("[ATTEMPT] Current position is",a);var s=[];return e.noteOption&&s.push(new r.b({key:r.a.Option,value:e.noteOption})),e.noteText&&s.push(new r.b({key:r.a.FreeText,value:e.noteText})),!0===e.isSuccess()&&s.push(new r.b({key:r.a.InputMethod,value:e.inputByBarcode?"Barcode":"Text"})),a&&s.push(new r.b({key:r.a.CurrentPosition,value:{lat:Object(o.c)(a,"coords.latitude"),lng:Object(o.c)(a,"coords.longitude"),accuracy:Object(o.c)(a,"coords.accuracy")}})),new i.a({jobId:e.id,delivered:e.isSuccess(),note:s,notePhotosB64:n.notePhotos,items:e.items.map(function(e){return{Id:e.id,ActualItemQty:e.actual}}),signatureB64:e.podSignature,photoB64:n.podPhoto})})},e.prototype.isItemsValid=function(e){return!1===this.isSuccess()||this.items.length===e.DeliveryItems.length&&this.items.every(function(t){return!!e.DeliveryItems.find(function(e){return e.Id===t.id&&e.ItemQty===t.expected})})},e.prototype.convertPhotosToBase64=function(){var e=this,t=[this.podPhoto].concat(this.notePhotos);return Promise.all(t.map(function(t){return e.fileToB64(t)})).then(function(e){return{podPhoto:e[0],notePhotos:e.slice(1)}})},e.prototype.fileToB64=function(e){return(e=Object(o.l)(e))?this.base64.encodeFile(e).catch(function(e){if("cordova_not_available"===e)return"";throw e}):Promise.resolve("")},e}()},168:function(e,t,n){"use strict";n.d(t,"a",function(){return a});n(2),n(149),n(150);var o=n(24),i=n(28),r=n(25),a=(n(44),function(){function e(e,t,n){this.camera=e,this.notify=t,this.scanner=n,this.cameraOptions={quality:50,destinationType:this.camera.DestinationType.FILE_URI,encodingType:this.camera.EncodingType.JPEG,sourceType:this.camera.PictureSourceType.CAMERA,mediaType:this.camera.MediaType.PICTURE,allowEdit:!0,targetWidth:1200,targetHeight:1200,saveToPhotoAlbum:!1,correctOrientation:!0},this.scanOptions={preferFrontCamera:!1,showFlipCameraButton:!0,showTorchButton:!0,torchOn:!1,disableAnimations:!0,disableSuccessBeep:!0,formats:r.a.setting.item.acceptedCodes,resultDisplayDuration:0,prompt:"Press back button to cancel"}}return e.prototype.getPicture=function(){var e=this;return this.camera.getPicture(this.cameraOptions).then(function(e){return Object(o.b)(e)}).catch(function(t){throw"No Image Selected"!==t&&"cordova_not_available"!==t&&e.notify.error(t),t})},e.prototype.scanBarcode=function(e){var t=this;void 0===e&&(e=!1);var n=e?{formats:"QR_CODE"}:{},o=Object.assign({},this.scanOptions,n);return this.scanner.scan(o).then(function(e){if(!0===e.cancelled)throw new Error("cancelled");return e}).catch(function(e){throw"Error: cancelled"!==e.toString()&&t.notify.error(Object(i.c)(e,"text","Unable to scan.")),e})},e}())},191:function(e,t){function n(e){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+e+"'.")})}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=191},213:function(e,t,n){function o(e){var t=i[e];return t?n.e(t[1]).then(function(){return n(t[0])}):Promise.reject(new Error("Cannot find module '"+e+"'."))}var i={"../pages/all-jobs/all-jobs.module.ngfactory":[417,1],"../pages/all-jobs/next-day-jobs/next-day-jobs.module.ngfactory":[418,9],"../pages/all-jobs/planner-notes/planner-notes.module.ngfactory":[419,8],"../pages/app-permission/app-permission.module.ngfactory":[420,25],"../pages/complete-job-details/complete-job-details.module.ngfactory":[421,4],"../pages/current-job/add-note/add-note.module.ngfactory":[422,0],"../pages/current-job/current-job.module.ngfactory":[423,5],"../pages/current-job/items-handled/items-handled.module.ngfactory":[424,7],"../pages/current-job/pod/pod-photo/pod-photo.module.ngfactory":[425,12],"../pages/current-job/pod/pod-signature/pod-signature.module.ngfactory":[426,13],"../pages/current-job/pod/pod.module.ngfactory":[427,11],"../pages/current-job/pod/verify-code/verify-code.module.ngfactory":[428,20],"../pages/current-job/summary/summary.module.ngfactory":[429,3],"../pages/customer-service/customer-service.module.ngfactory":[430,6],"../pages/home/home.module.ngfactory":[431,2],"../pages/item-details/item-details.module.ngfactory":[432,19],"../pages/login/check-app-version/check-app-version.module.ngfactory":[434,24],"../pages/login/licence-agreement/licence-agreement.module.ngfactory":[433,23],"../pages/login/login.module.ngfactory":[435,16],"../pages/login/scan-server-url/scan-server-url.module.ngfactory":[436,15],"../pages/settings/change-driver-details/change-driver-details.module.ngfactory":[438,18],"../pages/settings/logout/logout.module.ngfactory":[437,22],"../pages/settings/offline-job-modal/offline-job-modal.module.ngfactory":[439,14],"../pages/settings/offline-sync/offline-sync.module.ngfactory":[440,21],"../pages/settings/reset-password/reset-password.module.ngfactory":[441,17],"../pages/settings/settings.module.ngfactory":[442,10]};o.keys=function(){return Object.keys(i)},o.id=213,e.exports=o},25:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"d",function(){return r}),n.d(t,"b",function(){return u}),n.d(t,"a",function(){return c});var o,i=n(70);(o||(o={})).AllJobs="allJobsMenu";var r;!function(e){e.Eula="eula",e.Url="url",e.Username="username",e.ApiToken="token",e.PreviousJobsInfo="previousJobsInfo"}(r||(r={}));var a,s,u=function(){var e={};return e[e.Keyboard=0]="Keyboard",e[e.Barcode=1]="Barcode",e}(),c=function(){function e(){}return Object.defineProperty(e,"url",{get:function(){return e._url},set:function(t){e._url=t?t.replace(/[\/\\]+$/,""):""},enumerable:!0,configurable:!0}),e.defaultUrl="http://localhost",e._url=e.defaultUrl,e.default={url:e.defaultUrl,apiHeader:"x-access-token",setApiHeader:!0},e.login={page:"LoginPage",image:{path:"assets/images/logo_company.png",height:"70px"}},e.home={page:"HomePage",title:"SIMTech MCT <sup>TM</sup>"},e.features={forceAppUpdate:!0,showEula:!1,showChangeUrl:!0,showAllJobsMenu:!0,showPodPhotoTab:!0,showChangePassword:!0,showChangeDriverInfo:!0,showJobsMail:!0,showJobsReorderBtn:!1,enableSSLPinning:!1,enableWebsocket:!0,enableGeoTracking:!0,enableOfflineSync:!0},e.user={username:"",token:"",previousJobsInfo:"",vehicleId:"",vehiclePlateNumber:"",vehicleUserGroup:""},e.jobStatusPair=(a={},a[i.c.Pending]={title:"Pending",color:"blue"},a[i.c.Late]={title:"Late",color:"orange"},a[i.c.Ontime]={title:"Ontime",color:"green"},a[i.c.Unsuccessful]={title:"Unsuccessful",color:"red"},a[i.c.ExpectToBeLate]={title:"Expect Late",color:"purple"},a),e.jobTypePair=(s={},s[i.d.Pickup]={title:"PICKUP",color:"orange"},s[i.d.Delivery]={title:"DELIVERY",color:"blue"},s),e.setting={note:{maxNumPhoto:3,optionRequired:!1,options:["No problem","Incomplete order","Customer unavailable","Damaged product"]},pod:{photoRequired:!1},item:{defaultInput:u.Keyboard,allowSwitchInput:!0,acceptedCodes:"DATA_MATRIX,UPC_A,UPC_E,EAN_8,EAN_13,CODE_39,CODE_128,ITF"}},e}()},339:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return r});var o,i=n(28);!function(e){e.Option="Template",e.FreeText="Comments",e.InputMethod="Input Items By",e.CurrentPosition="ActualDeliveryLocation"}(o||(o={}));var r=function(){function e(e){Object.assign(this,e)}return Object.defineProperty(e.prototype,"key",{get:function(){return this._key},set:function(e){this._key=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){"string"==typeof e&&(e=Object(i.l)(e).replace(/(\r\n|\n|\r)/gm,". ")),this._value=e},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{key:this._key,value:this.value}},e.prototype.toString=function(){var e=this._value?this._value:"-";if(!0===this.isJson(this._value)){e="";for(var t in this._value)e+="("+t+") "+this._value[t]+". "}return this._key+": "+e},e.prototype.isJson=function(e){return e instanceof Object&&e.constructor===Object},e}()},371:function(e,t,n){"use strict";function o(e){return new d.a(e,"./assets/i18n/",".json")}function i(e){return s["ɵvid"](0,[(e()(),s["ɵeld"](0,0,null,null,9,"button",[["class","item item-block"],["detail-none",""],["ion-item",""]],null,[[null,"tap"]],function(e,t,n){var o=!0;if("tap"===t){o=!1!==e.component.btnOpenPage(e.context.$implicit)&&o}return o},Q.b,Q.a)),s["ɵdid"](1,1097728,null,3,$.a,[ee.a,te.a,s.ElementRef,s.Renderer,[2,ne.a]],null,null),s["ɵqud"](335544320,4,{contentLabel:0}),s["ɵqud"](603979776,5,{_buttons:1}),s["ɵqud"](603979776,6,{_icons:1}),s["ɵdid"](5,16384,null,0,oe.a,[],null,null),(e()(),s["ɵted"](-1,2,["\n                "])),(e()(),s["ɵeld"](7,0,null,0,1,"ion-icon",[["item-left",""],["role","img"]],[[2,"hide",null]],null,null,null,null)),s["ɵdid"](8,147456,[[6,4]],0,ie.a,[te.a,s.ElementRef,s.Renderer],{name:[0,"name"]},null),(e()(),s["ɵted"](9,2,["\n                ","\n            "]))],function(e,t){e(t,8,0,t.context.$implicit.icon)},function(e,t){e(t,7,0,s["ɵnov"](t,8)._hidden);e(t,9,0,t.context.$implicit.title)})}function r(e){return s["ɵvid"](0,[(e()(),s["ɵeld"](0,0,null,null,41,"ion-menu",[["persistent","true"],["role","navigation"],["side","right"]],null,null,null,re.b,re.a)),s["ɵprd"](6144,null,ae.a,null,[se.a]),s["ɵdid"](2,245760,null,2,se.a,[ue.a,s.ElementRef,te.a,ce.a,s.Renderer,le.a,de.l,pe.a,he.a],{content:[0,"content"],id:[1,"id"],side:[2,"side"],persistent:[3,"persistent"]},null),s["ɵqud"](335544320,1,{menuContent:0}),s["ɵqud"](335544320,2,{menuNav:0}),(e()(),s["ɵted"](-1,0,["\n\n    "])),(e()(),s["ɵeld"](6,0,null,0,23,"ion-header",[],null,null,null,null,null)),s["ɵdid"](7,16384,null,0,fe.a,[te.a,s.ElementRef,s.Renderer,[2,ge.a]],null,null),(e()(),s["ɵted"](-1,null,["\n        "])),(e()(),s["ɵeld"](9,0,null,null,19,"ion-toolbar",[["class","toolbar"]],[[2,"statusbar-padding",null]],null,null,me.b,me.a)),s["ɵdid"](10,49152,null,0,be.a,[te.a,s.ElementRef,s.Renderer],null,null),(e()(),s["ɵted"](-1,3,["\n            "])),(e()(),s["ɵeld"](12,0,null,3,2,"ion-title",[],null,null,null,ye.b,ye.a)),s["ɵdid"](13,49152,null,0,ve.a,[te.a,s.ElementRef,s.Renderer,[2,be.a],[2,je.a]],null,null),(e()(),s["ɵted"](-1,0,["Menu"])),(e()(),s["ɵted"](-1,3,["\n            "])),(e()(),s["ɵeld"](16,0,null,2,11,"ion-buttons",[["right",""]],null,null,null,null,null)),s["ɵdid"](17,16384,null,1,Pe.a,[te.a,s.ElementRef,s.Renderer,[2,be.a],[2,je.a]],null,null),s["ɵqud"](603979776,3,{_buttons:1}),(e()(),s["ɵted"](-1,null,["\n                "])),(e()(),s["ɵeld"](20,0,null,null,6,"button",[["clear",""],["ion-button",""]],null,[[null,"click"]],function(e,t,n){var o=!0;if("click"===t){o=!1!==s["ɵnov"](e,22).close()&&o}return o},Oe.b,Oe.a)),s["ɵdid"](21,1097728,[[3,4]],0,Se.a,[[8,""],te.a,s.ElementRef,s.Renderer],{clear:[0,"clear"]},null),s["ɵdid"](22,16384,null,0,Ie.a,[ue.a],{menuClose:[0,"menuClose"]},null),(e()(),s["ɵted"](-1,0,["\n                    "])),(e()(),s["ɵeld"](24,0,null,0,1,"ion-icon",[["name","close"],["role","img"]],[[2,"hide",null]],null,null,null,null)),s["ɵdid"](25,147456,null,0,ie.a,[te.a,s.ElementRef,s.Renderer],{name:[0,"name"]},null),(e()(),s["ɵted"](-1,0,["\n                "])),(e()(),s["ɵted"](-1,null,["\n            "])),(e()(),s["ɵted"](-1,3,["\n        "])),(e()(),s["ɵted"](-1,null,["\n    "])),(e()(),s["ɵted"](-1,0,["\n\n    "])),(e()(),s["ɵeld"](31,0,null,0,9,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,Ne.b,Ne.a)),s["ɵdid"](32,4374528,[[1,4]],0,Te.a,[te.a,ce.a,pe.a,s.ElementRef,s.Renderer,he.a,le.a,s.NgZone,[2,ge.a],[2,we.a]],null,null),(e()(),s["ɵted"](-1,1,["\n        "])),(e()(),s["ɵeld"](34,0,null,1,5,"ion-list",[],null,null,null,null,null)),s["ɵdid"](35,16384,null,0,Ce.a,[te.a,s.ElementRef,s.Renderer,ce.a,de.l,pe.a],null,null),(e()(),s["ɵted"](-1,null,["\n            "])),(e()(),s["ɵand"](16777216,null,null,1,null,i)),s["ɵdid"](38,802816,null,0,Ee.i,[s.ViewContainerRef,s.TemplateRef,s.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),s["ɵted"](-1,null,["\n        "])),(e()(),s["ɵted"](-1,1,["\n    "])),(e()(),s["ɵted"](-1,0,["\n\n"])),(e()(),s["ɵted"](-1,null,["\n\n"])),(e()(),s["ɵeld"](43,0,null,null,2,"ion-nav",[],null,null,null,Ae.b,Ae.a)),s["ɵprd"](6144,null,ae.a,null,[De.a]),s["ɵdid"](45,4374528,[["content",4]],0,De.a,[[2,ge.a],[2,we.a],he.a,te.a,ce.a,s.ElementRef,s.NgZone,s.Renderer,s.ComponentFactoryResolver,de.l,ke.a,[2,Je.a],pe.a,s.ErrorHandler],null,null),(e()(),s["ɵted"](-1,null,["\n"]))],function(e,t){var n=t.component;e(t,2,0,s["ɵnov"](t,45),n.allJobsMenuId,"right","true");e(t,21,0,"");e(t,22,0,n.allJobsMenuId);e(t,25,0,"close");e(t,38,0,n.allJobsMenuPages)},function(e,t){e(t,9,0,s["ɵnov"](t,10)._sbPadding);e(t,24,0,s["ɵnov"](t,25)._hidden);e(t,31,0,s["ɵnov"](t,32).statusbarPadding,s["ɵnov"](t,32)._hasRefresher)})}Object.defineProperty(t,"__esModule",{value:!0});var a=n(42),s=n(0),u=n(2),c=n(116),l=n(69),d=n(398),p=(n(24),n(131)),h=n(130),f=n(149),g=n(150),m=n(151),b=n(132),y=n(129),v=n(98),j=n(178),P=n(127),O=n(60),S=n(153),I=n(128),N=n(99),T=n(100),w=(n(370),n(25)),C=n(58),E=n(68),A=n(51),D=n(49),k=function(e){function t(t,n,o,i,r,a,s,u,c,l,d,p){var h=e.call(this,{app:t,platform:u})||this;return h.app=t,h.auth=n,h.driver=o,h.keyboard=i,h.menuCtrl=r,h.http=a,h.network=s,h.platform=u,h.statusBar=c,h.storage=l,h.splashScreen=d,h.translate=p,h.allJobsMenuId=w.c.AllJobs,h.allJobsMenuPages=[{name:"AllJobsPage",title:"Today's Jobs",icon:"checkmark-circle"},{name:"PlannerNotesPage",title:"Planner Notes",icon:"list"},{name:"NextDayJobsPage",title:"Next Day Jobs",icon:"calendar"}],h.initializeApp(),h}return Object(u.__extends)(t,e),t.prototype.initializeApp=function(){var e=this;this.platform.ready().then(function(){return e.splashScreen.show()}).then(function(){return e.storage.init()}).then(function(){e.http.setRequestTimeout(5),e.http.setDataSerializer("json");return e.http.setSSLCertMode(w.a.features.enableSSLPinning?"pinned":"default").catch(function(){})}).then(function(){e.translate.addLangs(["en"]),e.translate.setDefaultLang("en")}).then(function(){return e.auth.isLoggedIn().catch(function(){return e.auth.notifier.next(!1)})}).then(function(){e.menuCtrl.enable(!1,e.allJobsMenuId),e.keyboard.onKeyboardShow().subscribe(function(){return document.body.classList.add("keyboard-is-open")}),e.keyboard.onKeyboardHide().subscribe(function(){return document.body.classList.remove("keyboard-is-open")}),e.setStatusBar(),e.network.onDisconnect().subscribe(function(){return e.setStatusBar()}),e.network.onConnect().subscribe(function(){e.setStatusBar(),e.auth.isLoggedIn()}),e.splashScreen.hide()}),this.auth.notifier.distinctUntilChanged().subscribe(function(t){!0===t?setTimeout(function(){return e.goHomePage()}):!1===t&&setTimeout(function(){return e.goLoginPage()})}),this.platform.is("ios")&&this.platform.resume.subscribe(function(){return e.auth.isLoggedIn()})},t.prototype.btnOpenPage=function(e){this.goPage(e.name)},t.prototype.btnMainPage=function(){this.goHomePage()},t.prototype.setStatusBar=function(){this.statusBar.backgroundColorByName("none"===this.network.type?"red":"black")},t}(n(152).a),J=n(50),_=n(168),L=n(161),R=n(74),B=n(75),U=n(101),F=n(44),M=n(93),x=function(){return function(){}}(),q=n(62),V=n(358),H=n(359),G=n(360),K=n(361),W=n(362),z=n(363),X=n(364),Y=n(365),Z=n(366),Q=n(157),$=n(19),ee=n(16),te=n(3),ne=n(47),oe=n(71),ie=n(46),re=n(414),ae=n(35),se=n(91),ue=n(29),ce=n(5),le=n(31),de=n(7),pe=n(10),he=n(9),fe=n(103),ge=n(6),me=n(415),be=n(41),ye=n(368),ve=n(72),je=n(40),Pe=n(106),Oe=n(45),Se=n(23),Ie=n(124),Ne=n(367),Te=n(27),we=n(26),Ce=n(57),Ee=n(13),Ae=n(416),De=n(66),ke=n(34),Je=n(17),_e=s["ɵcrt"]({encapsulation:2,styles:[],data:{}}),Le=s["ɵccf"]("ng-component",k,function(e){return s["ɵvid"](0,[(e()(),s["ɵeld"](0,0,null,null,1,"ng-component",[],null,null,null,r,_e)),s["ɵdid"](1,49152,null,0,k,[he.a,C.a,D.a,v.a,ue.a,E.a,O.a,ce.a,N.a,A.a,T.a,l.k],null,null)],null,null)},{},{},[]),Re=n(134),Be=n(21),Ue=n(120),Fe=n(102),Me=n(133),xe=n(36),qe=n(123),Ve=n(158),He=n(64),Ge=n(48),Ke=n(105),We=n(87),ze=n(140),Xe=n(136),Ye=n(145),Ze=n(357),Qe=n(135),$e=n(125),et=n(137),tt=s["ɵcmf"](x,[q.b],function(e){return s["ɵmod"]([s["ɵmpd"](512,s.ComponentFactoryResolver,s["ɵCodegenComponentFactoryResolver"],[[8,[V.a,H.a,G.a,K.a,W.a,z.a,X.a,Y.a,Z.a,Le]],[3,s.ComponentFactoryResolver],s.NgModuleRef]),s["ɵmpd"](5120,s.LOCALE_ID,s["ɵq"],[[3,s.LOCALE_ID]]),s["ɵmpd"](4608,Ee.l,Ee.k,[s.LOCALE_ID,[2,Ee.t]]),s["ɵmpd"](5120,s.APP_ID,s["ɵi"],[]),s["ɵmpd"](5120,s.IterableDiffers,s["ɵn"],[]),s["ɵmpd"](5120,s.KeyValueDiffers,s["ɵo"],[]),s["ɵmpd"](4608,a.c,a.q,[Ee.c]),s["ɵmpd"](6144,s.Sanitizer,null,[a.c]),s["ɵmpd"](4608,a.f,Re.a,[]),s["ɵmpd"](5120,a.d,function(e,t,n,o,i){return[new a.k(e,t),new a.o(n),new a.n(o,i)]},[Ee.c,s.NgZone,Ee.c,Ee.c,a.f]),s["ɵmpd"](4608,a.e,a.e,[a.d,s.NgZone]),s["ɵmpd"](135680,a.m,a.m,[Ee.c]),s["ɵmpd"](4608,a.l,a.l,[a.e,a.m]),s["ɵmpd"](6144,s.RendererFactory2,null,[a.l]),s["ɵmpd"](6144,a.p,null,[a.m]),s["ɵmpd"](4608,s.Testability,s.Testability,[s.NgZone]),s["ɵmpd"](4608,a.h,a.h,[Ee.c]),s["ɵmpd"](4608,a.i,a.i,[Ee.c]),s["ɵmpd"](4608,c.h,c.n,[Ee.c,s.PLATFORM_ID,c.l]),s["ɵmpd"](4608,c.o,c.o,[c.h,c.m]),s["ɵmpd"](5120,c.a,function(e){return[e]},[c.o]),s["ɵmpd"](4608,c.k,c.k,[]),s["ɵmpd"](6144,c.i,null,[c.k]),s["ɵmpd"](4608,c.g,c.g,[c.i]),s["ɵmpd"](6144,c.b,null,[c.g]),s["ɵmpd"](4608,c.f,c.j,[c.b,s.Injector]),s["ɵmpd"](4608,c.c,c.c,[c.f]),s["ɵmpd"](4608,Be.t,Be.t,[]),s["ɵmpd"](4608,Be.d,Be.d,[]),s["ɵmpd"](5120,l.g,o,[c.c]),s["ɵmpd"](4608,l.c,l.e,[]),s["ɵmpd"](4608,l.i,l.d,[]),s["ɵmpd"](4608,l.b,l.a,[]),s["ɵmpd"](4608,l.n,l.n,[]),s["ɵmpd"](4608,l.k,l.k,[l.n,l.g,l.c,l.i,l.b,l.l,l.m]),s["ɵmpd"](4608,Ue.a,Ue.a,[he.a,te.a]),s["ɵmpd"](4608,Fe.a,Fe.a,[he.a,te.a]),s["ɵmpd"](4608,Me.a,Me.a,[]),s["ɵmpd"](4608,ee.a,ee.a,[]),s["ɵmpd"](4608,xe.a,xe.a,[ce.a]),s["ɵmpd"](4608,le.a,le.a,[te.a,ce.a,s.NgZone,pe.a]),s["ɵmpd"](4608,qe.a,qe.a,[he.a,te.a]),s["ɵmpd"](5120,Ee.g,Ve.c,[Ee.r,[2,Ee.a],te.a]),s["ɵmpd"](4608,Ee.f,Ee.f,[Ee.g]),s["ɵmpd"](5120,He.b,He.d,[he.a,He.a]),s["ɵmpd"](5120,Je.a,Je.b,[he.a,He.b,Ee.f,Ge.b,s.ComponentFactoryResolver]),s["ɵmpd"](4608,Ke.a,Ke.a,[he.a,te.a,Je.a]),s["ɵmpd"](4608,We.a,We.a,[he.a,te.a]),s["ɵmpd"](4608,ze.a,ze.a,[he.a,te.a,Je.a]),s["ɵmpd"](4608,Xe.a,Xe.a,[te.a,ce.a,pe.a,he.a,de.l]),s["ɵmpd"](4608,Ye.a,Ye.a,[he.a,te.a]),s["ɵmpd"](4608,ke.a,ke.a,[ce.a,te.a]),s["ɵmpd"](4608,f.a,f.a,[]),s["ɵmpd"](4608,P.a,P.a,[]),s["ɵmpd"](4608,F.a,F.a,[Ye.a,P.a]),s["ɵmpd"](4608,g.a,g.a,[]),s["ɵmpd"](4608,_.a,_.a,[f.a,F.a,g.a]),s["ɵmpd"](4608,p.a,p.a,[]),s["ɵmpd"](4608,b.a,b.a,[]),s["ɵmpd"](4608,O.a,O.a,[]),s["ɵmpd"](4608,E.a,E.a,[c.c,s.Injector,O.a,ce.a]),s["ɵmpd"](4608,J.e,J.e,[E.a]),s["ɵmpd"](4608,R.a,R.a,[p.a,b.a,J.e,F.a,ce.a]),s["ɵmpd"](4608,B.a,B.a,[ce.a]),s["ɵmpd"](4608,U.a,U.a,[qe.a,ce.a]),s["ɵmpd"](4608,I.a,I.a,[]),s["ɵmpd"](4608,A.a,A.a,[I.a]),s["ɵmpd"](4608,M.b,M.b,[]),s["ɵmpd"](4608,J.a,J.a,[E.a]),s["ɵmpd"](4608,J.b,J.b,[E.a]),s["ɵmpd"](4608,J.c,J.c,[E.a]),s["ɵmpd"](4608,J.d,J.d,[E.a]),s["ɵmpd"](4608,J.f,J.f,[E.a]),s["ɵmpd"](4608,h.a,h.a,[]),s["ɵmpd"](4608,D.a,D.a,[Fe.a,B.a,J.c,U.a,F.a,A.a,J.f,M.b]),s["ɵmpd"](4608,C.a,C.a,[J.a,h.a,R.a,D.a,F.a,A.a,M.b]),s["ɵmpd"](4608,m.a,m.a,[]),s["ɵmpd"](4608,L.a,L.a,[m.a,R.a,D.a,B.a,Ke.a]),s["ɵmpd"](4608,y.a,y.a,[]),s["ɵmpd"](4608,v.a,v.a,[]),s["ɵmpd"](4608,j.a,j.a,[]),s["ɵmpd"](4608,S.a,S.a,[]),s["ɵmpd"](4608,N.a,N.a,[]),s["ɵmpd"](4608,T.a,T.a,[]),s["ɵmpd"](512,Ee.b,Ee.b,[]),s["ɵmpd"](512,s.ErrorHandler,Ze.a,[]),s["ɵmpd"](256,te.b,{tabsPlacement:"top",tabsHideOnSubPages:!0,scrollAssist:!1,autoFocusAssist:!1,activator:"highlight"},[]),s["ɵmpd"](1024,Qe.a,Qe.b,[]),s["ɵmpd"](1024,ce.a,ce.b,[a.b,Qe.a,s.NgZone]),s["ɵmpd"](1024,te.a,te.c,[te.b,ce.a]),s["ɵmpd"](512,pe.a,pe.a,[ce.a]),s["ɵmpd"](512,ue.a,ue.a,[]),s["ɵmpd"](512,he.a,he.a,[te.a,ce.a,[2,ue.a]]),s["ɵmpd"](512,de.l,de.l,[he.a]),s["ɵmpd"](256,He.a,{links:[{loadChildren:"../pages/all-jobs/all-jobs.module.ngfactory#AllJobsPageModuleNgFactory",name:"AllJobsPage",segment:"all-jobs",priority:"low",defaultHistory:[]},{loadChildren:"../pages/all-jobs/next-day-jobs/next-day-jobs.module.ngfactory#NextDayJobsPageModuleNgFactory",name:"NextDayJobsPage",segment:"next-day-jobs",priority:"low",defaultHistory:[]},{loadChildren:"../pages/all-jobs/planner-notes/planner-notes.module.ngfactory#PlannerNotesPageModuleNgFactory",name:"PlannerNotesPage",segment:"planner-notes",priority:"low",defaultHistory:[]},{loadChildren:"../pages/app-permission/app-permission.module.ngfactory#AppPermissionPageModuleNgFactory",name:"AppPermissionPage",segment:"app-permission",priority:"low",defaultHistory:[]},{loadChildren:"../pages/complete-job-details/complete-job-details.module.ngfactory#CompleteJobDetailsPageModuleNgFactory",name:"CompleteJobDetailsPage",segment:"complete-job-details",priority:"low",defaultHistory:[]},{loadChildren:"../pages/current-job/add-note/add-note.module.ngfactory#AddNotePageModuleNgFactory",name:"AddNotePage",segment:"add-note",priority:"low",defaultHistory:[]},{loadChildren:"../pages/current-job/current-job.module.ngfactory#CurrentJobPageModuleNgFactory",name:"CurrentJobPage",segment:"current-job",priority:"low",defaultHistory:[]},{loadChildren:"../pages/current-job/items-handled/items-handled.module.ngfactory#ItemsHandledPageModuleNgFactory",name:"ItemsHandledPage",segment:"items-handled",priority:"low",defaultHistory:[]},{loadChildren:"../pages/current-job/pod/pod-photo/pod-photo.module.ngfactory#PodPhotoPageModuleNgFactory",name:"PodPhotoPage",segment:"pod-photo",priority:"low",defaultHistory:[]},{loadChildren:"../pages/current-job/pod/pod-signature/pod-signature.module.ngfactory#PodSignaturePageModuleNgFactory",name:"PodSignaturePage",segment:"pod-signature",priority:"low",defaultHistory:[]},{loadChildren:"../pages/current-job/pod/pod.module.ngfactory#PodPageModuleNgFactory",name:"PodPage",segment:"pod",priority:"low",defaultHistory:[]},{loadChildren:"../pages/current-job/pod/verify-code/verify-code.module.ngfactory#VerifyCodePageModuleNgFactory",name:"VerifyCodePage",segment:"verify-code",priority:"low",defaultHistory:[]},{loadChildren:"../pages/current-job/summary/summary.module.ngfactory#SummaryPageModuleNgFactory",name:"SummaryPage",segment:"summary",priority:"low",defaultHistory:[]},{loadChildren:"../pages/customer-service/customer-service.module.ngfactory#CustomerServicePageModuleNgFactory",name:"CustomerServicePage",segment:"customer-service",priority:"low",defaultHistory:[]},{loadChildren:"../pages/home/home.module.ngfactory#HomePageModuleNgFactory",name:"HomePage",segment:"home",priority:"low",defaultHistory:[]},{loadChildren:"../pages/item-details/item-details.module.ngfactory#ItemDetailsPageModuleNgFactory",name:"ItemDetailsPage",segment:"item-details",priority:"low",defaultHistory:[]},{loadChildren:"../pages/login/licence-agreement/licence-agreement.module.ngfactory#LicenceAgreementPageModuleNgFactory",name:"LicenceAgreementPage",segment:"licence-agreement",priority:"low",defaultHistory:[]},{loadChildren:"../pages/login/check-app-version/check-app-version.module.ngfactory#CheckAppVersionPageModuleNgFactory",name:"CheckAppVersionPage",segment:"check-app-version",priority:"low",defaultHistory:[]},{loadChildren:"../pages/login/login.module.ngfactory#LoginPageModuleNgFactory",name:"LoginPage",segment:"login",priority:"low",defaultHistory:[]},{loadChildren:"../pages/login/scan-server-url/scan-server-url.module.ngfactory#ScanServerUrlPageModuleNgFactory",name:"ScanServerUrlPage",segment:"scan-server-url",priority:"low",defaultHistory:[]},{loadChildren:"../pages/settings/logout/logout.module.ngfactory#LogoutPageModuleNgFactory",name:"LogoutPage",segment:"logout",priority:"low",defaultHistory:[]},{loadChildren:"../pages/settings/change-driver-details/change-driver-details.module.ngfactory#ChangeDriverDetailsPageModuleNgFactory",name:"ChangeDriverDetailsPage",segment:"change-driver-details",priority:"low",defaultHistory:[]},{loadChildren:"../pages/settings/offline-job-modal/offline-job-modal.module.ngfactory#OfflineJobModalPageModuleNgFactory",name:"OfflineJobModalPage",segment:"offline-job-modal",priority:"low",defaultHistory:[]},{loadChildren:"../pages/settings/offline-sync/offline-sync.module.ngfactory#OfflineSyncPageModuleNgFactory",name:"OfflineSyncPage",segment:"offline-sync",priority:"low",defaultHistory:[]},{loadChildren:"../pages/settings/reset-password/reset-password.module.ngfactory#ResetPasswordPageModuleNgFactory",name:"ResetPasswordPage",segment:"reset-password",priority:"low",defaultHistory:[]},{loadChildren:"../pages/settings/settings.module.ngfactory#SettingPageModuleNgFactory",name:"SettingPage",segment:"settings",priority:"low",defaultHistory:[]}]},[]),s["ɵmpd"](512,s.Compiler,s.Compiler,[]),s["ɵmpd"](512,$e.a,$e.a,[s.Compiler]),s["ɵmpd"](1024,Ge.b,Ge.c,[$e.a,s.Injector]),s["ɵmpd"](1024,s.APP_INITIALIZER,function(e,t,n,o,i,r,s,u,c,l,d,p,h){return[a.s(e),et.a(t),Me.b(n,o),Xe.b(i,r,s,u,c),Ge.d(l,d,p,h)]},[[2,s.NgProbeToken],te.a,ce.a,pe.a,te.a,ce.a,pe.a,he.a,de.l,te.a,He.a,Ge.b,s.NgZone]),s["ɵmpd"](512,s.ApplicationInitStatus,s.ApplicationInitStatus,[[2,s.APP_INITIALIZER]]),s["ɵmpd"](131584,s.ApplicationRef,s.ApplicationRef,[s.NgZone,s["ɵConsole"],s.Injector,s.ErrorHandler,s.ComponentFactoryResolver,s.ApplicationInitStatus]),s["ɵmpd"](512,s.ApplicationModule,s.ApplicationModule,[s.ApplicationRef]),s["ɵmpd"](512,a.a,a.a,[[3,a.a]]),s["ɵmpd"](512,c.e,c.e,[]),s["ɵmpd"](512,c.d,c.d,[]),s["ɵmpd"](512,l.h,l.h,[]),s["ɵmpd"](512,Be.r,Be.r,[]),s["ɵmpd"](512,Be.j,Be.j,[]),s["ɵmpd"](512,Be.p,Be.p,[]),s["ɵmpd"](512,Ve.a,Ve.a,[]),s["ɵmpd"](512,x,x,[]),s["ɵmpd"](256,c.l,"XSRF-TOKEN",[]),s["ɵmpd"](256,c.m,"X-XSRF-TOKEN",[]),s["ɵmpd"](256,l.m,void 0,[]),s["ɵmpd"](256,l.l,void 0,[]),s["ɵmpd"](256,q.a,k,[]),s["ɵmpd"](256,Ee.a,"/",[])])});Object(s.enableProdMode)(),Object(a.j)().bootstrapModuleFactory(tt).catch(function(e){return console.error(e)})},406:function(e,t,n){function o(e){return n(i(e))}function i(e){var t=r[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var r={"./af":216,"./af.js":216,"./ar":217,"./ar-dz":218,"./ar-dz.js":218,"./ar-kw":219,"./ar-kw.js":219,"./ar-ly":220,"./ar-ly.js":220,"./ar-ma":221,"./ar-ma.js":221,"./ar-sa":222,"./ar-sa.js":222,"./ar-tn":223,"./ar-tn.js":223,"./ar.js":217,"./az":224,"./az.js":224,"./be":225,"./be.js":225,"./bg":226,"./bg.js":226,"./bm":227,"./bm.js":227,"./bn":228,"./bn.js":228,"./bo":229,"./bo.js":229,"./br":230,"./br.js":230,"./bs":231,"./bs.js":231,"./ca":232,"./ca.js":232,"./cs":233,"./cs.js":233,"./cv":234,"./cv.js":234,"./cy":235,"./cy.js":235,"./da":236,"./da.js":236,"./de":237,"./de-at":238,"./de-at.js":238,"./de-ch":239,"./de-ch.js":239,"./de.js":237,"./dv":240,"./dv.js":240,"./el":241,"./el.js":241,"./en-au":242,"./en-au.js":242,"./en-ca":243,"./en-ca.js":243,"./en-gb":244,"./en-gb.js":244,"./en-ie":245,"./en-ie.js":245,"./en-il":246,"./en-il.js":246,"./en-nz":247,"./en-nz.js":247,"./eo":248,"./eo.js":248,"./es":249,"./es-do":250,"./es-do.js":250,"./es-us":251,"./es-us.js":251,"./es.js":249,"./et":252,"./et.js":252,"./eu":253,"./eu.js":253,"./fa":254,"./fa.js":254,"./fi":255,"./fi.js":255,"./fo":256,"./fo.js":256,"./fr":257,"./fr-ca":258,"./fr-ca.js":258,"./fr-ch":259,"./fr-ch.js":259,"./fr.js":257,"./fy":260,"./fy.js":260,"./gd":261,"./gd.js":261,"./gl":262,"./gl.js":262,"./gom-latn":263,"./gom-latn.js":263,"./gu":264,"./gu.js":264,"./he":265,"./he.js":265,"./hi":266,"./hi.js":266,"./hr":267,"./hr.js":267,"./hu":268,"./hu.js":268,"./hy-am":269,"./hy-am.js":269,"./id":270,"./id.js":270,"./is":271,"./is.js":271,"./it":272,"./it.js":272,"./ja":273,"./ja.js":273,"./jv":274,"./jv.js":274,"./ka":275,"./ka.js":275,"./kk":276,"./kk.js":276,"./km":277,"./km.js":277,"./kn":278,"./kn.js":278,"./ko":279,"./ko.js":279,"./ky":280,"./ky.js":280,"./lb":281,"./lb.js":281,"./lo":282,"./lo.js":282,"./lt":283,"./lt.js":283,"./lv":284,"./lv.js":284,"./me":285,"./me.js":285,"./mi":286,"./mi.js":286,"./mk":287,"./mk.js":287,"./ml":288,"./ml.js":288,"./mn":289,"./mn.js":289,"./mr":290,"./mr.js":290,"./ms":291,"./ms-my":292,"./ms-my.js":292,"./ms.js":291,"./mt":293,"./mt.js":293,"./my":294,"./my.js":294,"./nb":295,"./nb.js":295,"./ne":296,"./ne.js":296,"./nl":297,"./nl-be":298,"./nl-be.js":298,"./nl.js":297,"./nn":299,"./nn.js":299,"./pa-in":300,"./pa-in.js":300,"./pl":301,"./pl.js":301,"./pt":302,"./pt-br":303,"./pt-br.js":303,"./pt.js":302,"./ro":304,"./ro.js":304,"./ru":305,"./ru.js":305,"./sd":306,"./sd.js":306,"./se":307,"./se.js":307,"./si":308,"./si.js":308,"./sk":309,"./sk.js":309,"./sl":310,"./sl.js":310,"./sq":311,"./sq.js":311,"./sr":312,"./sr-cyrl":313,"./sr-cyrl.js":313,"./sr.js":312,"./ss":314,"./ss.js":314,"./sv":315,"./sv.js":315,"./sw":316,"./sw.js":316,"./ta":317,"./ta.js":317,"./te":318,"./te.js":318,"./tet":319,"./tet.js":319,"./tg":320,"./tg.js":320,"./th":321,"./th.js":321,"./tl-ph":322,"./tl-ph.js":322,"./tlh":323,"./tlh.js":323,"./tr":324,"./tr.js":324,"./tzl":325,"./tzl.js":325,"./tzm":326,"./tzm-latn":327,"./tzm-latn.js":327,"./tzm.js":326,"./ug-cn":328,"./ug-cn.js":328,"./uk":329,"./uk.js":329,"./ur":330,"./ur.js":330,"./uz":331,"./uz-latn":332,"./uz-latn.js":332,"./uz.js":331,"./vi":333,"./vi.js":333,"./x-pseudo":334,"./x-pseudo.js":334,"./yo":335,"./yo.js":335,"./zh-cn":336,"./zh-cn.js":336,"./zh-hk":337,"./zh-hk.js":337,"./zh-tw":338,"./zh-tw.js":338};o.keys=function(){return Object.keys(r)},o.resolve=i,e.exports=o,o.id=406},44:function(e,t,n){"use strict";n.d(t,"a",function(){return i});n(2),n(24),n(127);var o=n(28),i=function(){function e(e,t){this.toastCtrl=e,this.localNotifications=t,this.maxCharacters=254,this.toastOptions={showCloseButton:!0,position:"top",duration:3e3}}return e.prototype.error=function(e,t){console.log("[TOAST] Error:",e,t);var n=Object(o.j)(e);return Object(o.d)(n,"Error")||(n="Error: "+n),void 0!==t&&(n+="\n\nServer Error: ",t instanceof Error?n+=t.toString():n+=JSON.stringify(t)),this.show({message:n,duration:this.toastOptions.duration+3e3})},e.prototype.info=function(e){return this.show({message:JSON.stringify(e)})},e.prototype.success=function(e){return console.log("[TOAST] Success:",e),this.show({message:"Success: "+e})},e.prototype.local=function(e){this.localNotifications.schedule({title:"Logistics",text:e,priority:2,launch:!0,clock:!0,lockscreen:!0,smallIcon:"res://logo",color:"#1f7bb6"})},e.prototype.show=function(e){if(e.message=Object(o.l)(e.message),e.message){var t=e.message.substring(0,this.maxCharacters);e.message=t+=t===e.message?"":"..."}return this.toastCtrl.create(Object.assign({},this.toastOptions,e)).present()},e}()},49:function(e,t,n){"use strict";n.d(t,"a",function(){return u});n(2),n(24);var o=n(28),i=n(1),r=(n.n(i),n(25)),a=n(70),s=(n(75),n(101),n(44),n(51),n(93)),u=(n(50),function(){function e(e,t,n,o,i,r,a,s){this.alertCtrl=e,this.geolocation=t,this.jobsApi=n,this.loading=o,this.notify=i,this.storage=r,this.vehicleApi=a,this.websocket=s,this.jobs=[],this.isSyncing=!1,this.DATE_FORMAT="DD/MM/YYYY"}return e.prototype.initDriver=function(e){console.log("[INIT] Initialising driver"),this.setDriver(e),this.initWebsocketEvents(),this.geolocation.start(this.vehicleId,this.vehiclePlateNumber,this.vehicleUserGroup)},e.prototype.setDriver=function(e){return console.log("[INIT] Setting driver variables and uploading offline jobs"),this.name=e.fullname,this.vehicleId=e.vehicleId,this.vehiclePlateNumber=e.vehiclePlateNumber,this.vehicleUserGroup=e.vehicleUserGroup,r.a.user.vehicleId=this.vehicleId,r.a.user.vehiclePlateNumber=this.vehiclePlateNumber,r.a.user.vehicleUserGroup=this.vehicleUserGroup,this.configureFeatures(e),this.getJobsFromServer().then(this.uploadOfflineJobs).catch(function(){})},e.prototype.resetDriver=function(){this.name=void 0,this.vehicleId=void 0,this.vehiclePlateNumber=void 0,this.vehicleUserGroup=void 0,this.jobs=[],this.currentJob=void 0,this.geolocation.stop()},e.prototype.jobAttempt=function(e){var t=this,n=i();return this.uploadOfflineJobs().catch(function(e){console.log("[ATTEMPT] Ignoring error from upload offline jobs before attempt",e)}).then(function(){var o=t.jobsApi.attempt(e).then(function(e){return t.onUpdateJob(e)});return!1===r.a.features.enableOfflineSync?o:(console.log("[ATTEMPT] Saving job into database "+e.jobId),t.storage.insertJob({jobId:e.jobId,attemptedByDriver:t.name,attemptedByVehicle:t.vehiclePlateNumber,delivered:e.delivered,deliveryTime:n.toISOString(),signatureB64:e.signatureB64,photoB64:e.photoB64,notePhotosB64:e.notePhotosB64,note:e.note,items:e.items}).then(function(i){var r=t.jobs.find(function(t){return t.Id===e.jobId});t.onUpdateJob({Id:e.jobId,Status:r.estimateStatus(e.delivered,n.toISOString()),ActualDeliveryTime:n.toDate(),NoteFromDriver:e.note}),o.then(function(){return t.storage.deleteJob(i)}).catch(function(e){return console.log("[ATTEMPT] Failed to send request to server",e)})}).catch(function(){return o}))})},e.prototype.getOfflineJobs=function(){return!1===r.a.features.enableOfflineSync?Promise.reject("Offline sync feature is not enabled."):this.storage.getAllJobs().then(function(e){return e.map(function(e){return new a.a(e)})})},e.prototype.uploadOfflineJobs=function(){var e=this;return!1===r.a.features.enableOfflineSync?Promise.reject("Offline sync feature is not enabled."):(console.log("Uploading offline jobs"),!0===this.isSyncing?this.notify.error("Currently uploading data to server. Please try again 5 minutes later.").then(function(){}):(this.isSyncing=!0,this.getOfflineJobs().then(function(t){return e.isSyncing=!1,t.length>0?e.jobsApi.sync(t).then(function(){return e.getJobsFromServer()}).then(function(){e.storage.deleteAllJobs()}):Promise.resolve()}).catch(function(t){throw e.isSyncing=!1,t})))},e.prototype.updateCurrentJob=function(){this.currentJob=this.jobs.find(function(e){return e.isPending()})},e.prototype.updatePlateNumber=function(e){return this.vehicleApi.update(this.vehicleId,{PlateNumber:e})},e.prototype.isPreviousJobComplete=function(e){return!0===e.isPickup()||!this.jobs.find(function(t){return t.DeliveryMasterId===e.DeliveryMasterId&&t.Id!==e.Id&&t.isPickup()&&t.JobSequence<=e.JobSequence&&!t.isCompleted()})},e.prototype.getJobsFromServer=function(e){var t=this;void 0===e&&(e="Updating jobs");var n=this.loading.show(e),a=i().toISOString(),s=!1,u=r.a.user.previousJobsInfo,c=u?u.split(","):[],l=c[0],d=void 0===l?"":l,p=c[1],h=void 0===p?"":p;return this.jobsApi.get({date:a}).then(function(e){if(e.length!==Number(d)&&i(h,t.DATE_FORMAT).isSame(i(),"day"))s=!0;else if(t.jobs.length>0)for(var a=0;a<e.length;a++){if(!Object(o.b)(t.jobs,{Id:e[a].Id})){s=!0;break}}if(t.jobs=e.sort(function(e,t){return e.EngineRouteSeqNum<t.EngineRouteSeqNum?-1:1}),t.updateCurrentJob(),n.dismiss(),s){var u="Updated jobs list for today";t.notify.local(u),t.notify.info(u)}r.a.user.previousJobsInfo=e.length.toString()+","+i().format(t.DATE_FORMAT),t.storage.setKeyValue(r.d.PreviousJobsInfo,r.a.user.previousJobsInfo)}).catch(function(e){n.dismiss();throw t.alertCtrl.create({title:"Error",subTitle:"Unable to get updated job list.<br>Please log out and log in again. Server Error: "+e,buttons:["OK"]}).present(),e})},e.prototype.configureFeatures=function(e){e.statusLabels.forEach(function(e){var t=r.a.jobStatusPair[e.value];t&&(t.title=Object(o.a)(e.label))}),r.a.setting.note.maxNumPhoto=e.noteOptions.photo.maxCount,r.a.setting.note.optionRequired=e.noteOptions.option.required,r.a.setting.note.options=e.noteOptions.option.list,r.a.setting.pod.photoRequired=e.podOptions.photo.required,r.a.setting.item.defaultInput="BARCODE"===e.itemOptions.input.default?r.b.Barcode:r.b.Keyboard,r.a.setting.item.allowSwitchInput=e.itemOptions.input.allowToggle,r.a.setting.item.acceptedCodes=e.itemOptions.barcode.formats},e.prototype.initWebsocketEvents=function(){var e=this;this.websocket.onJSON(s.a.Vehicle,function(t){t.purpose!==s.c.Update&&t.purpose!==s.c.Create||t.data.forEach(function(t){return e.onUpdateVehicle(t)})}),this.websocket.onJSON(s.a.DeliveryPlan,function(t){if(t.purpose===s.c.Update||t.purpose===s.c.Create){t.data.indexOf(i().format("YYYY-MM-DD"))>-1&&e.getJobsFromServer()}}),this.websocket.onJSON(s.a.DeliveryMaster,function(t){t.purpose===s.c.Delete&&e.onDeleteJob(t.data)}),this.websocket.onJSON(s.a.DeliveryDetail,function(t){t.purpose!==s.c.Update&&t.purpose!==s.c.Attempted||t.data.forEach(function(t){return e.onUpdateJob(t)})}),this.websocket.onJSON(s.a.DeliveryItem,function(t){if(t.purpose===s.c.Create){var n=Number(t.data[0].DeliveryDetailId);e.onUpdateJob({Id:n,DeliveryItems:t.data})}else t.purpose===s.c.Delete&&t.data.forEach(function(t){var n=Number(t.DeliveryDetailId),o=e.jobs.find(function(e){return e.Id===n}).DeliveryItems;e.onUpdateJob({Id:n,DeliveryItems:o.filter(function(e){return t.Ids.indexOf(e.Id)<0})})})})},e.prototype.onUpdateVehicle=function(e){var t=this.vehicleId;this.vehicleId=e.Id,this.vehiclePlateNumber=e.PlateNumber,this.vehicleUserGroup=e.UserGroup,t!==this.vehicleId&&(console.log("[WEBSOCKET] Changed vehicle assignment from "+t+" to "+this.vehicleId),this.getJobsFromServer("Updating jobs due to change of vehicle...")),this.geolocation.start(this.vehicleId,this.vehiclePlateNumber,this.vehicleUserGroup)},e.prototype.onUpdateJob=function(e){e.Id=Number(e.Id);var t=this.jobs.find(function(t){return t.Id===e.Id});Object.assign(t,e),!0===t.isUnsuccessful()&&!0===t.isPickup()&&this.jobs.forEach(function(e){t.DeliveryMasterId===e.DeliveryMasterId&&t.JobSequence<=e.JobSequence&&e.isDelivery()&&e.isPending()&&(e.Status=a.c.Unsuccessful)}),!1===Object(o.e)(this.currentJob,t.Id)&&this.updateCurrentJob()},e.prototype.onDeleteJob=function(e){var t=this,n=!1;Object(o.h)(this.jobs,function(o){if(e.indexOf(o.DeliveryMasterId)>-1)return t.notify.info("Job "+o.DeliveryMasterId+" ("+o.JobType+") has been removed."),!n&&e.indexOf(t.currentJob.DeliveryMasterId)>-1&&(n=!0),!0}),n&&this.updateCurrentJob()},e}())},50:function(e,t,n){"use strict";n(2),n(0);var o=n(28),i=(n(68),n(70)),r=function(){function e(e){Object.assign(this,e)}return Object.defineProperty(e.prototype,"Id",{get:function(){return this._Id},set:function(e){this._Id=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Weight",{get:function(){return this._Weight},set:function(e){this._Weight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Description",{get:function(){return this._Description},set:function(e){this._Description=e},enumerable:!0,configurable:!0}),e}(),a=n(25),s=function(){return function(e){this.forceChangePassword=!1,this.noteOptions={option:{required:a.a.setting.note.optionRequired,list:a.a.setting.note.options},photo:{maxCount:a.a.setting.note.maxNumPhoto}},this.podOptions={photo:{required:a.a.setting.pod.photoRequired}},this.itemOptions={input:{default:a.a.setting.item.defaultInput===a.b.Barcode?"BARCODE":"TEXT",allowToggle:a.a.setting.item.allowSwitchInput},barcode:{formats:a.a.setting.item.acceptedCodes}},this.statusLabels=[],Object.assign(this,e)}}();n.d(t,"a",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"b",function(){return d}),n.d(t,"f",function(){return p}),n.d(t,"e",function(){return h}),n.d(t,"d",function(){return f});var u=function(){function e(){}return e.catch=function(e){throw 0===e.status?new Error("Invalid URL. Error: "+e.error):-1===e.status&&e.error?e.error.split("Exception: ").pop():e.error},e}(),c=function(){function e(e){this.http=e}return e.prototype.isLoggedIn=function(){return this.http.get("web/auth/v2/isLoggedIn").then(function(e){return new s(e)}).catch(u.catch)},e.prototype.resetPassword=function(e){return void 0===e&&(e={}),this.http.put("api/auth/v2/password",e).catch(u.catch)},e.prototype.login=function(e){return void 0===e&&(e={}),this.http.post("api/auth/v2/login",e).then(function(e){return new s(e)}).catch(function(e){var t=e.error;throw 401===e.status?t="Incorrect username or password.":0===e.status||404===e.status?t="Please check that the server URL is valid.":-1===e.status&&e.error?t="Unable to log in. "+e.error.split("Exception: ").pop():"string"!=typeof t&&(t="Unable to log in. "+JSON.stringify(t)),t})},e.prototype.logout=function(){return this.http.post("api/auth/v2/logout",{}).catch(u.catch)},e}(),l=function(){function e(e){this.http=e}return e.prototype.get=function(e){return void 0===e&&(e={}),this.http.get("web/data/v2.1/job",e).then(function(e){return Object(o.g)(e,function(e){return new i.b(e)})}).catch(u.catch)},e.prototype.attempt=function(e){return this.http.put("api/data/v2.1/job/"+e.jobId+"/attemptB64",e.withBase64()).catch(u.catch)},e.prototype.sync=function(e){return void 0===e&&(e=[]),this.http.post("api/data/v2.1/job/syncB64",Object(o.g)(e,function(e){return e.withBase64()})).catch(u.catch)},e.prototype.getPodPhotos=function(e){return this.http.get("web/data/v2.1/pod/"+e).catch(u.catch)},e.prototype.getNotePhotos=function(e){return this.http.get("web/data/v2.1/note/"+e).catch(u.catch)},e}(),d=function(){function e(e){this.http=e}return e.prototype.get=function(e){return this.http.get("web/data/v2.1/item/"+e).then(function(e){return new r(e)}).catch(u.catch)},e}(),p=function(){function e(e){this.http=e}return e.prototype.update=function(e,t){return this.http.put("api/data/v2.1/vehicle/"+e,{newValues:t}).catch(u.catch)},e}(),h=function(){function e(e){this.http=e}return e.prototype.getLatestAppVersion=function(){return this.http.get("web/data/v2.1/misc/app/version",{},{"Content-Type":"application/text"}).catch(u.catch)},e}(),f=function(){function e(e){this.http=e}return e.prototype.send=function(e){return this.http.post("api/message/v2",e).catch(u.catch)},e}()},51:function(e,t,n){"use strict";n(2),n(0),n(128);var o=n(25),i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=function(){function e(e,t,n,o){this.name=e,this.version=t,this.db=n,this.columns=o}return e.prototype.sqlCreate=function(){var e="CREATE TABLE IF NOT EXISTS "+this.name+" ("+this.getSchema()+")";return this.db.executeSql(e,[]).then(function(){return!0})},e.prototype.sqlDrop=function(){return this.db.executeSql("DROP TABLE IF EXISTS "+this.name,[]).then(function(){return!0})},e.prototype.getFirstRow=function(e){return e.rows.length>0?e.rows.item(0):void 0},e.prototype.getAllRows=function(e){for(var t=[],n=0;n<e.rows.length;n++)t.push(e.rows.item(n));return t},e.prototype.getInsertedId=function(e){if(e.rowsAffected>0)return e.insertId;throw new Error("Unable to store record in database")},e.prototype.getRowsAffected=function(e){return e.rowsAffected},e.prototype.getSchema=function(){return this.columns.map(function(e){return e.getSchema()}).join(",")},e}(),a=function(){function e(e,t,n){this.name=e,this.type=t,this.isJSON=!1,this.isBase64=!1,this.isPrimaryKey=!1,Object.assign(this,n)}return e.prototype.getSchema=function(){return this.name+" "+this.type+" "+(this.isPrimaryKey?"PRIMARY KEY":"")},e}(),s=function(e){function t(t){return e.call(this,"jobs",1,t,[new a("jobId","INTEGER"),new a("attemptedByDriver","TEXT"),new a("attemptedByVehicle","TEXT"),new a("delivered","BOOLEAN"),new a("deliveryTime","TEXT"),new a("signatureB64","TEXT",{isBase64:!0}),new a("photoB64","TEXT",{isBase64:!0}),new a("notePhotosB64","TEXT",{isJSON:!0,isBase64:!0}),new a("note","TEXT",{isJSON:!0}),new a("items","TEXT",{isJSON:!0})])||this}return i(t,e),t.prototype.sqlSelect=function(){return this.db.executeSql("SELECT * FROM "+this.name,[]).then(this.getAllRows)},t.prototype.sqlInsert=function(e){var t=[],n=[];for(var o in e)t.push(o),n.push(e[o]instanceof Object?JSON.stringify(e[o]):e[o]);var i="INSERT INTO "+this.name+" ("+t.join(",")+") VALUES ("+n.map(function(){return"?"})+")";return this.db.executeSql(i,n).then(this.getInsertedId)},t.prototype.sqlDelete=function(e){return this.db.executeSql("DELETE FROM "+this.name+" WHERE rowId = ?",[e]).then(function(e){return e.rowsAffected})},t.prototype.sqlDeleteAll=function(){return this.db.executeSql("DELETE FROM "+this.name,[]).then(function(e){return e.rowsAffected})},t}(r),u=function(e){function t(t){return e.call(this,"keyvalue",1,t,[new a("key","TEXT",{isPrimaryKey:!0}),new a("value","TEXT")])||this}return i(t,e),t.prototype.sqlGetValue=function(e){return this.db.executeSql("SELECT value FROM "+this.name+" WHERE key = ?",[e]).then(this.getFirstRow).then(function(e){return e?e.value:void 0})},t.prototype.sqlSetValue=function(e,t){return this.db.executeSql("INSERT OR REPLACE INTO "+this.name+" VALUES (?, ?)",[e,t]).then(this.getRowsAffected)},t}(r);n.d(t,"a",function(){return c});var c=function(){function e(e){this.sqlite=e,this.databaseName="simtech.opms.lml"}return e.prototype.init=function(){var e=this;return this.sqlite.create({name:this.databaseName,location:"default"}).then(function(t){return e.tableKeyVal=new u(t),e.tableJobs=new s(t),e.createTables()}).then(function(){return o.a.features.showChangeUrl?e.getKeyValue(o.d.Url).then(function(e){void 0!==e&&(o.a.url=e)}):e.setKeyValue(o.d.Url,o.a.default.url).then(function(){})}).then(function(){return e.getKeyValue(o.d.ApiToken).then(function(e){void 0!==e&&(o.a.user.token=e)})}).then(function(){return e.getKeyValue(o.d.Username).then(function(e){void 0!==e&&(o.a.user.username=e)})}).then(function(){return e.getKeyValue(o.d.PreviousJobsInfo).then(function(e){void 0!==e&&(o.a.user.previousJobsInfo=e)})}).catch(function(){})},e.prototype.insertJob=function(e){return void 0===this.tableJobs?Promise.reject("Tables are not initialised"):this.tableJobs.sqlInsert(e)},e.prototype.getAllJobs=function(){var e=this;return void 0===this.tableJobs?Promise.reject("Tables are not initialised"):this.tableJobs.sqlSelect().then(function(t){return t.map(function(t){return t.delivered=e.toBool(t.delivered),t.notePhotosB64=e.toJSON(t.notePhotosB64),t.note=e.toJSON(t.note),t.items=e.toJSON(t.items),t})})},e.prototype.deleteAllJobs=function(){return void 0===this.tableJobs?Promise.reject("Tables are not initialised"):this.tableJobs.sqlDeleteAll()},e.prototype.deleteJob=function(e){return void 0===this.tableJobs?Promise.reject("Tables are not initialised"):this.tableJobs.sqlDelete(e)},e.prototype.setKeyValue=function(e,t){return void 0===this.tableKeyVal?Promise.resolve(void 0):this.tableKeyVal.sqlSetValue(e,t)},e.prototype.getKeyValue=function(e){return void 0===this.tableKeyVal?Promise.resolve(void 0):this.tableKeyVal.sqlGetValue(e)},e.prototype.toJSON=function(e){try{return JSON.parse(e)}catch(t){return e}},e.prototype.toBool=function(e){return"true"===e||!0===e},e.prototype.createTables=function(){var e=this;return this.tableKeyVal.sqlCreate().then(function(){return e.tableKeyVal.sqlGetValue(e.tableJobs.name)}).then(function(t){if(console.log("[SQL] Current jobs table database version "+t),void 0===t||Number(t)<Number(e.tableJobs.version))return console.log("[SQL] Updating jobs table to version "+e.tableJobs.version),e.tableJobs.sqlDrop().then(function(){return e.tableJobs.sqlCreate()}).then(function(){return e.tableKeyVal.sqlSetValue(e.tableJobs.name,String(e.tableJobs.version))})}).then(function(){})},e}()},58:function(e,t,n){"use strict";n.d(t,"a",function(){return c});n(2),n(130);var o=n(340),i=(n.n(o),n(28)),r=n(1),a=(n.n(r),n(25)),s=(n(50),n(44),n(49),n(51),n(74)),u=n(93),c=function(){function e(e,t,n,i,r,a,s){this.authApi=e,this.backgroundMode=t,this.diagnostic=n,this.driver=i,this.notify=r,this.storage=a,this.websocket=s,this.notifier=new o.BehaviorSubject(void 0),this.forceChangePassword=!1}return e.prototype.login=function(e,t){var n=this;return this.authApi.login({username:e,password:t}).then(function(e){n.initUser(e),n.driver.initDriver(e)}).catch(function(e){throw n.resetUser(),e})},e.prototype.logout=function(){var e=this;return void 0===this.username?(this.notifier.next(!1),Promise.resolve()):this.authApi.logout().then(function(){e.resetUser()}).catch(function(){e.resetUser()})},e.prototype.isLoggedIn=function(){var e=this;return this.authApi.isLoggedIn().then(function(t){e.setUser(t),e.driver.setDriver(t)}).catch(function(t){throw e.resetUser(),t})},e.prototype.changePassword=function(e,t){return this.authApi.resetPassword({oldPassword:e,newPassword:t})},e.prototype.initUser=function(e){console.log("[INIT] Initialising user"),this.setUser(e),this.diagnostic.deviceOS===s.b.iOS&&this.backgroundMode.enable(),this.initWebsocketEvents()},e.prototype.setUser=function(e){console.log("[INIT] Setting user variables"),a.a.user.token=e.token,this.storage.setKeyValue(a.d.ApiToken,a.a.user.token),a.a.user.username=e.username,this.username=a.a.user.username,this.storage.setKeyValue(a.d.Username,a.a.user.username),this.forceChangePassword=e.forceChangePassword,this.synchroniseDate(e.serverDate),this.notifier.next(!0)},e.prototype.resetUser=function(){a.a.user.token="",a.a.user.previousJobsInfo="",a.a.user.vehicleId="",a.a.user.vehiclePlateNumber="",a.a.user.vehicleUserGroup="",this.storage.setKeyValue(a.d.ApiToken,""),this.storage.setKeyValue(a.d.PreviousJobsInfo,""),this.username=void 0,this.websocket.disconnect(),this.driver.resetDriver(),this.backgroundMode.isEnabled&&this.backgroundMode.disable(),this.notifier.next(!1)},e.prototype.synchroniseDate=function(e){if(e=Object(i.l)(e)){var t=new Date(e).getTime()-Date.now();r.now=function(){return t+Date.now()}}},e.prototype.initWebsocketEvents=function(){var e=this;this.websocket.connect(),this.websocket.onJSON(u.a.Logout,function(){e.notify.error("You are forced to log out. You will be redirected to login page."),e.resetUser()})},e}()},68:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var o,i=n(2),r=n(129),a=n(25),s=n(58);n(60),n(24);!function(e){e.GET="get",e.POST="post",e.PUT="put"}(o||(o={}));var u=function(e){function t(t,n,o,i){var r=e.call(this)||this;return r.http=t,r.injector=n,r.network=o,r.platform=i,r.useNativeHttp=!1,r.useNativeHttp=r.platform.is("ios")||r.platform.is("android"),console.log("[API] Using Native HTTP "+r.useNativeHttp),r}return Object(i.__extends)(t,e),t.prototype.get=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n={}),this.sendRequestToServer(o.GET,[e,t,n])},t.prototype.post=function(e,t,n){return void 0===n&&(n={}),this.sendRequestToServer(o.POST,[e,t,n])},t.prototype.put=function(e,t,n){return void 0===n&&(n={}),this.sendRequestToServer(o.PUT,[e,t,n])},t.prototype.sendRequestToServer=function(t,n){var i=this,r=a.a.url,u=n[0],c=n[1]||{},l=n[2]||{};!0===a.a.default.setApiHeader&&((f={})[a.a.default.apiHeader]=a.a.user.token,l=f);var d=r+"/"+u;if(console.log("[API] Sending request to "+d,c,l),"none"===this.network.type)return Promise.reject({error:"Internet is required."});var p;if(this.useNativeHttp)p=e.prototype[t].call(this,d,c,l);else{var h={withCredentials:!0,headers:l};p=t===o.GET?this.http.get(d,Object.assign({params:c},h)).toPromise():this.http[t.toString()](d,c,h).toPromise()}return p.then(function(e){console.log("[API] Success "+d,e);try{return JSON.parse(e.data)}catch(t){return e}}).catch(function(e){if(console.log("[API] Error "+d,e),i.useNativeHttp)try{e.error=JSON.parse(e.error)}catch(e){}else e.status=-1;if(401===e.status){i.injector.get(s.a).logout()}throw e});var f},t}(r.a)},70:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"b",function(){return u}),n.d(t,"a",function(){return c});var o,i=n(1),r=(n.n(i),n(28)),a=n(339);!function(e){e[e.Pending=1]="Pending",e[e.Late=2]="Late",e[e.Ontime=3]="Ontime",e[e.Unsuccessful=4]="Unsuccessful",e[e.ExpectToBeLate=5]="ExpectToBeLate"}(o||(o={}));var s;!function(e){e.Pickup="PICKUP",e.Delivery="DELIVERY"}(s||(s={}));var u=function(){function e(e){Object.assign(this,e)}return Object.defineProperty(e.prototype,"Id",{get:function(){return this._Id},set:function(e){this._Id=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DeliveryMasterId",{get:function(){return this._DeliveryMasterId},set:function(e){this._DeliveryMasterId=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"JobType",{get:function(){return this._JobType},set:function(e){this._JobType=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Status",{get:function(){return this._Status},set:function(e){this._Status=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Address",{get:function(){return this._Address},set:function(e){this._Address=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Postal",{get:function(){return this._Postal},set:function(e){this._Postal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lat",{get:function(){return this._Lat},set:function(e){this._Lat=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lng",{get:function(){return this._Lng},set:function(e){this._Lng=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ContactName",{get:function(){return this._ContactName},set:function(e){this._ContactName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ContactPhone",{get:function(){return this._ContactPhone},set:function(e){this._ContactPhone=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"JobSequence",{get:function(){return this._JobSequence},set:function(e){this._JobSequence=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EngineRouteSeqNum",{get:function(){return this._EngineRouteSeqNum},set:function(e){this._EngineRouteSeqNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"StartTimeWindow",{get:function(){return this._StartTimeWindow},set:function(e){this._StartTimeWindow=e?i(e).toDate():void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndTimeWindow",{get:function(){return this._EndTimeWindow},set:function(e){this._EndTimeWindow=e?i(e).toDate():void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ActualDeliveryTime",{get:function(){return this._ActualDeliveryTime},set:function(e){this._ActualDeliveryTime=e?i(e).toDate():void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"NoteFromPlanner",{get:function(){return this._NoteFromPlanner},set:function(e){this._NoteFromPlanner=this.initNotes(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"NoteFromDriver",{get:function(){return this._NoteFromDriver},set:function(e){this._NoteFromDriver=this.initNotes(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DeliveryItems",{get:function(){return this._DeliveryItems},set:function(e){this._DeliveryItems=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VerificationCode",{get:function(){return this._VerificationCode},set:function(e){this._VerificationCode=this.initVerificationCode(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UserGroup",{get:function(){return this._UserGroup},set:function(e){this._UserGroup=e},enumerable:!0,configurable:!0}),e.prototype.estimateStatus=function(e,t){return void 0===e&&(e=!1),!1===e?o.Unsuccessful:i(this.EndTimeWindow).isAfter(i(t))?o.Ontime:o.Late},e.prototype.toJSON=function(){return{Id:this._Id,DeliveryMasterId:this._DeliveryMasterId,JobType:this._JobType,Status:this._Status,Address:this._Address,Postal:this._Postal,Lat:this._Lat,Lng:this._Lng,ContactName:this._ContactName,ContactPhone:this._ContactPhone,JobSequence:this._JobSequence,StartTimeWindow:this._StartTimeWindow,EndTimeWindow:this._EndTimeWindow,NoteFromPlanner:JSON.stringify(Object(r.g)(this._NoteFromPlanner,function(e){return e.toJSON()})),NoteFromDriver:JSON.stringify(Object(r.g)(this._NoteFromDriver,function(e){return e.toJSON()})),UserGroup:this._UserGroup}},e.prototype.isPickup=function(){return this.JobType===s.Pickup},e.prototype.isDelivery=function(){return this.JobType===s.Delivery},e.prototype.isPending=function(){return this.Status===o.Pending||this.Status===o.ExpectToBeLate},e.prototype.isUnsuccessful=function(){return this.Status===o.Unsuccessful},e.prototype.isCompleted=function(){return!this.isPending()&&!this.isUnsuccessful()},e.prototype.hasVerificationCode=function(){return!!this._VerificationCode},e.prototype.verifyCode=function(e){return Object(r.k)(Object(r.l)(e))===Object(r.k)(Object(r.l)(this._VerificationCode.Code))},e.prototype.initNotes=function(e){return void 0===e&&(e=[]),e=Object(r.f)(e)?[]:e,Object(r.g)(e,function(e){return new a.b(e)})},e.prototype.initVerificationCode=function(e){return e&&"string"==typeof e?{Code:e}:e},e}(),c=function(){function e(e){var t=this;Object.assign(this,e),this.signature=this.b64ToBlob(this.signatureB64),this.photo=this.b64ToBlob(this.photoB64),this.notePhotos=Object(r.g)(this.notePhotosB64,function(e){return t.b64ToBlob(e)}),void 0!==e.note&&e.note.length&&(this.note=Object(r.g)(e.note,function(e){return new a.b(e)}))}return e.prototype.withBase64=function(){var e=this;return Object.assign({notePhotos:Object(r.g)(this.notePhotosB64,function(t){return e.trimB64Uri(t)}),signature:this.trimB64Uri(this.signatureB64),photo:this.trimB64Uri(this.photoB64)},this.getJobDetails())},e.prototype.withBuffer=function(){return Object.assign({notePhotos:this.notePhotos,signature:this.signature,photo:this.photo},this.getJobDetails())},e.prototype.getJobDetails=function(){return{jobId:this.jobId,delivered:this.delivered,note:Object(r.g)(this.note,function(e){return e.toJSON()}),items:this.items,attemptedByDriver:this.attemptedByDriver,attemptedByVehicle:this.attemptedByVehicle,deliveryTime:this.deliveryTime}},e.prototype.trimB64Uri=function(e){if(e=Object(r.l)(e))return e.indexOf(";base64,")?e.split(";base64,").pop():void 0},e.prototype.b64ToBlob=function(e,t){void 0===t&&(t="image/jpeg");if(e=this.trimB64Uri(e)){for(var n=atob(e),o=[],i=0;i<n.length;i+=512){for(var r=n.slice(i,i+512),a=new Array(r.length),s=0;s<r.length;s++)a[s]=r.charCodeAt(s);var u=new Uint8Array(a);o.push(u)}return new Blob(o,{type:t})}},e}()},74:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return s});n(2),n(24);var o,i=n(340),r=(n.n(i),n(28)),a=(n(131),n(132),n(25));n(50),n(44);!function(e){e.Android="android",e.iOS="ios"}(o||(o={}));var s=function(){function e(e,t,n,a,s){var u=this;this.appVersion=e,this.diagnostic=t,this.miscApi=n,this.notify=a,this.platform=s,this.hasLocationNotifier=new i.BehaviorSubject(!1),this.platform.ready().then(function(){!0===u.platform.is(o.Android)?u.deviceOS=o.Android:!0===u.platform.is(o.iOS)&&(u.deviceOS=o.iOS);var e=u.platform.versions();u.deviceVersion=Object(r.c)(e[u.deviceOS],"num"),u.diagnostic.registerLocationStateChangeHandler(function(e){u.diagnostic.getLocationAuthorizationStatus().then(function(t){u.hasLocationNotifier.next(!0===(u.deviceOS===o.Android&&e!==u.diagnostic.locationMode.LOCATION_OFF&&t!==u.diagnostic.permissionStatus.NOT_REQUESTED)||!0===(u.deviceOS===o.iOS&&(t===u.diagnostic.permissionStatus.GRANTED||t===u.diagnostic.permissionStatus.GRANTED_WHEN_IN_USE)))})})})}return e.prototype.isAppUpdated=function(){var e=this;return!1===a.a.features.forceAppUpdate?Promise.resolve(!0):this.appVersion.getVersionNumber().then(function(t){return console.log("[DIAGNOSTIC] Current app version "+t),void 0===t||e.miscApi.getLatestAppVersion().then(function(n){return console.log("[DIAGNOSTIC] Latest app version "+n),e.normalizeVersionNum(t)>=e.normalizeVersionNum(n)})}).catch(function(){return!0})},e.prototype.getPackageName=function(){return this.appVersion.getPackageName()},e.prototype.hasLocationPermission=function(){var e=this;return this.diagnostic.isLocationAvailable().then(function(t){return e.hasLocationNotifier.next(t),t}).catch(function(t){return e.catch("location",t)})},e.prototype.hasCameraPermission=function(){var e=this;return this.diagnostic.isCameraAvailable().catch(function(t){return e.catch("camera",t)})},e.prototype.requestLocation=function(){var e=this;this.diagnostic.isLocationAvailable().then(function(t){if(!0!==t)return e.diagnostic.getLocationAuthorizationStatus().then(function(t){e.diagnostic.isLocationEnabled().then(function(n){e.platform.is("android")?n?t!==e.diagnostic.permissionStatus.DENIED&&t!==e.diagnostic.permissionStatus.DENIED_ALWAYS&&t!==e.diagnostic.permissionStatus.NOT_REQUESTED||e.diagnostic.switchToLocationSettings():e.diagnostic.switchToLocationSettings():n?t!==e.diagnostic.permissionStatus.DENIED&&t!==e.diagnostic.permissionStatus.DENIED_ALWAYS&&t!==e.diagnostic.permissionStatus.NOT_REQUESTED||e.diagnostic.switchToSettings():e.notify.info("Please go to Setting >> Privacy >> Location Services to turn on your Location service.")})});e.hasLocationNotifier.next(t),e.notify.info("Location permission is already enabled.")}).catch(function(t){return e.catch("location",t)})},e.prototype.requestCamera=function(){var e=this;this.diagnostic.isCameraAvailable().then(function(t){!0===t?e.notify.info("Camera permission is already enabled."):e.diagnostic.requestCameraAuthorization()}).catch(function(t){return e.catch("camera",t)})},e.prototype.catch=function(e,t){return void 0===e&&this.notify.error("Unable to check "+e+" permission details "+t),!0},e.prototype.normalizeVersionNum=function(e){var t=Number(Object(r.l)(e).replace(/\./g,""));return isNaN(t)?0:t},e}()},75:function(e,t,n){"use strict";n.d(t,"a",function(){return r});n(2),n(24);var o=n(28),i=n(25),r=function(){function e(e){var t=this;this.platform=e,this.apiMethod="POST",this.apiRootProperty="record",this.apiFormat='{\n        "Lat": "<%= latitude %>",\n        "Lng": "<%= longitude %>",\n        "Accuracy": "<%= accuracy %>",\n        "RecordedTime": "<%= timestamp %>"\n    }',this.geolocationOptions={desiredAccuracy:0,distanceFilter:10,stationaryRadius:25,debug:!1,logLevel:0,reset:!0,pausesLocationUpdatesAutomatically:!1,activityRecognitionInterval:1e4,stopTimeout:5,stopOnTerminate:!1,startOnBoot:!0,heartbeatInterval:60,preventSuspend:!0,locationAuthorizationRequest:"Always",foregroundService:!0,notificationChannelName:"Location Tracker",fastestLocationUpdateInterval:5e3,allowIdenticalLocations:!0,autoSync:i.a.features.enableGeoTracking,httpTimeout:2e4,method:this.apiMethod,httpRootProperty:this.apiRootProperty,locationTemplate:this.apiFormat,batchSync:!0,maxBatchSize:5e3,maxDaysToPersist:2,schedule:["1-7 7:00-23:00"]},this.platform.ready().then(function(){var e=window.BackgroundGeolocation;void 0!==e&&(t.bgGeo=e,t.bgGeo.on("location",function(e){return console.log("[LOCATION] onLocation",e)},function(e){return console.log("[LOCATION] onLocation",e)}),t.bgGeo.on("http",function(e){return console.log("[LOCATION] onHttp",e)},function(e){return console.log("[LOCATION] onHttpErr",e)}))})}return e.prototype.start=function(e,t,n){var o=this;if(void 0!==this.bgGeo&&!0===i.a.features.enableGeoTracking){var r=Object.assign({},this.geolocationOptions,{url:i.a.url+"/rest/data/v2.1/vehicleLog",headers:(a={},a[i.a.default.apiHeader]=i.a.user.token,a),extras:{VehicleId:e,PlateNumber:t,VehicleUserGroup:n}});this.bgGeo.setConfig(r).then(function(){o.bgGeo.start()}).catch(function(e){return console.log("[LOCATION] Unable to start background tracking.",e)})}var a},e.prototype.stop=function(){void 0!==this.bgGeo&&!0===i.a.features.enableGeoTracking&&this.bgGeo.stop()},e.prototype.getCurrentLocation=function(){return void 0!==this.bgGeo?this.bgGeo.getCurrentPosition({timeout:10,maximumAge:1e4,samples:1}).then(function(e){return{coords:{latitude:Object(o.c)(e,"coords.latitude"),longitude:Object(o.c)(e,"coords.longitude"),accuracy:Object(o.c)(e,"coords.accuracy")}}}):Promise.resolve({coords:{latitude:void 0,longitude:void 0,accuracy:void 0}})},e}()},93:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s});n(2);var o,i=n(411),r=(n.n(i),n(25));!function(e){e.Create="create",e.Update="update",e.Delete="delete",e.Attempted="attempted"}(o||(o={}));var a;!function(e){e.DeliveryMaster="DeliveryMaster",e.DeliveryDetail="DeliveryDetail",e.DeliveryItem="DeliveryItem",e.DeliveryPlan="DeliveryPlan",e.Vehicle="Vehicle",e.Logout="logout"}(a||(a={}));var s=function(){function e(){this.eventsToCreate=[]}return e.prototype.connect=function(){var e=this;if(!1!==r.a.features.enableWebsocket)if(void 0!==this.socket&&!0===this.socket.connected)console.log("[WEBSOCKET] Already connected to websocket");else{var t=r.a.url;r.a.default.setApiHeader&&(t+="?"+r.a.default.apiHeader+"="+r.a.user.token),console.log("[WEBSOCKET] Connecting to "+t),this.socket=i(t),this.eventsToCreate.length&&(this.eventsToCreate.forEach(function(t){return e.onJSON(t.name,t.successFn,t.errorFn)}),this.eventsToCreate=[])}},e.prototype.disconnect=function(){!1!==r.a.features.enableWebsocket&&void 0!==this.socket&&!0===this.socket.connected&&this.socket.disconnect()},e.prototype.onJSON=function(e,t,n){!1===r.a.features.enableWebsocket||this.socket.hasListeners(e)||(this.socket?this.socket.on(e,function(o){try{var i=JSON.parse(o);console.log("[WEBSOCKET] Event: ("+e+"). Message:",i),t&&t(i)}catch(t){console.log("[WEBSOCKET] Event: ("+e+"). Message:",o,t),n&&n(t)}}):this.eventsToCreate.push({name:e,successFn:t,errorFn:n}))},e}()}},[371]);