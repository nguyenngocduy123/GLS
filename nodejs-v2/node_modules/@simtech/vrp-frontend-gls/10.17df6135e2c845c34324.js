(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{MfMb:function(e,n,t){"use strict";t.d(n,"a",function(){return m}),t.d(n,"b",function(){return x});var l=t("CcnG"),i=(t("36nB"),t("Ip0R")),a=(t("M2Lx"),t("Wf4p")),o=(t("Fzqc"),t("dWZg")),r=t("UodH"),s=t("SMsm"),u=t("/VYK"),c=t("seP3"),d=t("b716"),h=t("Mr+X"),b=t("bujt"),p=t("lLAP"),f=t("wFw1"),g=t("gIcY"),m=(t("uGex"),l.Va({encapsulation:0,styles:[".mat-select-search-hidden[_ngcontent-%COMP%]{visibility:hidden}.mat-select-search-inner[_ngcontent-%COMP%]{position:absolute;top:0;width:100%;border-bottom-width:1px;border-bottom-style:solid;z-index:100;font-size:inherit;-webkit-box-shadow:none;box-shadow:none;border-radius:0}.mat-select-search-inner.mat-select-search-inner-multiple[_ngcontent-%COMP%]{width:100%}  .mat-select-search-panel{-webkit-transform:none!important;transform:none!important;max-height:350px;overflow-x:hidden}.mat-select-search-input[_ngcontent-%COMP%]{padding:16px 36px 16px 16px;-webkit-box-sizing:border-box;box-sizing:border-box}.mat-select-search-no-entries-found[_ngcontent-%COMP%]{padding:16px}.mat-select-search-clear[_ngcontent-%COMP%]{position:absolute;right:4px;top:5px}  .cdk-overlay-pane-select-search{margin-top:-50px}"],data:{}}));function v(e){return l.rb(0,[l.gb(null,0),(e()(),l.Oa(0,null,null,0))],null,null)}function _(e){return l.rb(0,[(e()(),l.Xa(0,0,null,null,2,"mat-icon",[["class","mat-icon"],["role","img"]],[[2,"mat-icon-inline",null]],null,null,h.b,h.a)),l.Wa(1,638976,null,0,s.a,[l.l,s.c,[8,null]],null,null),(e()(),l.pb(-1,0,["close"]))],function(e,n){e(n,1,0)},function(e,n){e(n,0,0,l.hb(n,1).inline)})}function y(e){return l.rb(0,[(e()(),l.Xa(0,0,null,null,4,"button",[["aria-label","Clear"],["class","mat-select-search-clear"],["mat-button",""],["mat-icon-button",""]],[[8,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],function(e,n,t){var l=!0;return"click"===n&&(l=!1!==e.component._reset(!0)&&l),l},b.d,b.b)),l.Wa(1,180224,null,0,r.b,[l.l,o.a,p.h,[2,f.a]],null,null),(e()(),l.Oa(16777216,null,0,1,null,v)),l.Wa(3,16384,null,0,i.m,[l.U,l.R],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(e()(),l.Oa(0,[["defaultIcon",2]],0,0,null,_))],function(e,n){e(n,3,0,n.component.clearIcon,l.hb(n,4))},function(e,n){e(n,0,0,l.hb(n,1).disabled||null,"NoopAnimations"===l.hb(n,1)._animationMode)})}function k(e){return l.rb(0,[(e()(),l.Xa(0,0,null,null,1,"div",[["class","mat-select-search-no-entries-found"]],null,null,null,null,null)),(e()(),l.pb(1,null,[" ","\n"]))],null,function(e,n){e(n,1,0,n.component.noEntriesFoundLabel)})}function x(e){return l.rb(2,[l.nb(402653184,1,{searchSelectInput:0}),l.nb(402653184,2,{innerSelectSearch:0}),(e()(),l.Xa(2,0,null,null,2,"input",[["class","mat-select-search-input mat-select-search-hidden mat-input-element mat-form-field-autofill-control"],["matInput",""]],[[2,"mat-input-server",null],[1,"id",0],[1,"placeholder",0],[8,"disabled",0],[8,"required",0],[8,"readOnly",0],[1,"aria-describedby",0],[1,"aria-invalid",0],[1,"aria-required",0]],[[null,"blur"],[null,"focus"],[null,"input"]],function(e,n,t){var i=!0;return"blur"===n&&(i=!1!==l.hb(e,4)._focusChanged(!1)&&i),"focus"===n&&(i=!1!==l.hb(e,4)._focusChanged(!0)&&i),"input"===n&&(i=!1!==l.hb(e,4)._onInput()&&i),i},null,null)),l.mb(6144,null,c.d,null,[d.b]),l.Wa(4,999424,null,0,d.b,[l.l,o.a,[8,null],[2,g.t],[2,g.k],a.d,[8,null],u.a,l.C],null,null),(e()(),l.Xa(5,0,[[2,0],["innerSelectSearch",1]],null,7,"div",[["class","mat-select-search-inner mat-typography mat-datepicker-content mat-tab-header"]],null,null,null,null,null)),l.Wa(6,278528,null,0,i.k,[l.v,l.w,l.l,l.I],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),l.kb(7,{"mat-select-search-inner-multiple":0}),(e()(),l.Xa(8,0,[[1,0],["searchSelectInput",1]],null,2,"input",[["autocomplete","off"],["class","mat-select-search-input mat-input-element mat-form-field-autofill-control"],["matInput",""]],[[2,"mat-input-server",null],[1,"id",0],[1,"placeholder",0],[8,"disabled",0],[8,"required",0],[8,"readOnly",0],[1,"aria-describedby",0],[1,"aria-invalid",0],[1,"aria-required",0]],[[null,"keydown"],[null,"input"],[null,"blur"],[null,"focus"]],function(e,n,t){var i=!0,a=e.component;return"blur"===n&&(i=!1!==l.hb(e,10)._focusChanged(!1)&&i),"focus"===n&&(i=!1!==l.hb(e,10)._focusChanged(!0)&&i),"input"===n&&(i=!1!==l.hb(e,10)._onInput()&&i),"keydown"===n&&(i=!1!==a._handleKeydown(t)&&i),"input"===n&&(i=!1!==a.onInputChange(t.target.value)&&i),"blur"===n&&(i=!1!==a.onBlur(t.target.value)&&i),i},null,null)),l.mb(6144,null,c.d,null,[d.b]),l.Wa(10,999424,null,0,d.b,[l.l,o.a,[8,null],[2,g.t],[2,g.k],a.d,[8,null],u.a,l.C],{placeholder:[0,"placeholder"]},null),(e()(),l.Oa(16777216,null,null,1,null,y)),l.Wa(12,16384,null,0,i.m,[l.U,l.R],{ngIf:[0,"ngIf"]},null),(e()(),l.Oa(16777216,null,null,1,null,k)),l.Wa(14,16384,null,0,i.m,[l.U,l.R],{ngIf:[0,"ngIf"]},null)],function(e,n){var t=n.component;e(n,4,0),e(n,6,0,"mat-select-search-inner mat-typography mat-datepicker-content mat-tab-header",e(n,7,0,t.matSelect.multiple)),e(n,10,0,t.placeholderLabel),e(n,12,0,t.value),e(n,14,0,t.noEntriesFoundLabel&&t.value&&0===(null==t._options?null:t._options.length))},function(e,n){e(n,2,0,l.hb(n,4)._isServer,l.hb(n,4).id,l.hb(n,4).placeholder,l.hb(n,4).disabled,l.hb(n,4).required,l.hb(n,4).readonly,l.hb(n,4)._ariaDescribedby||null,l.hb(n,4).errorState,l.hb(n,4).required.toString()),e(n,8,0,l.hb(n,10)._isServer,l.hb(n,10).id,l.hb(n,10).placeholder,l.hb(n,10).disabled,l.hb(n,10).required,l.hb(n,10).readonly,l.hb(n,10)._ariaDescribedby||null,l.hb(n,10).errorState,l.hb(n,10).required.toString())})}},ukLw:function(e,n,t){"use strict";t.r(n);var l=t("CcnG"),i=function(){},a=t("Qm6G"),o=t("NcP4"),r=t("t68o"),s=t("xYTU"),u=t("zbXB"),c=t("CQVA"),d=t("pMnS"),h=t("fiJ/"),b=t("k10Q"),p=t("0G9l"),f=t("7jv/"),g=t("JsB9"),m=t("44rI"),v=t("MXbC"),_=t("O7jx"),y=t("MlvX"),k=t("Wf4p"),x=t("Ip0R"),I=t("dJrM"),L=t("seP3"),C=t("Fzqc"),w=t("dWZg"),T=t("wFw1"),O=t("Azqq"),S=t("uGex"),D=t("gIcY"),M=t("qAlS"),V=t("MfMb"),A=t("36nB"),J=t("ny24"),P=t("K9Ia"),R=t("S5bw"),W=function(){function e(){this._onDestroy=new P.b,this.isCaseSensitive=!1,this.showUndefinedOption=!1,this.placeholder="Select",this.selectCtrl=new D.g,this.selectFilterCtrl=new D.g,this.filteredSelections=new R.a(1),this.selectedChange=new l.n}return e.prototype.ngOnInit=function(){var e=this;this.selectFilterCtrl.valueChanges.pipe(Object(J.a)(this._onDestroy)).subscribe(function(){e.filterSelections()})},e.prototype.ngOnDestroy=function(){this._onDestroy.next(),this._onDestroy.complete()},e.prototype.ngOnChanges=function(e){e.selections&&this.selections&&this.filteredSelections.next(this.selections.slice())},Object.defineProperty(e.prototype,"selected",{get:function(){return this._selectedOption},set:function(e){this._selectedOption=e,this.selectedChange.emit(this._selectedOption),this.selections&&this.filteredSelections.next(this.selections.slice().sort(function(n,t){return n===e?-1:t===e?1:0}))},enumerable:!0,configurable:!0}),e.prototype.filterSelections=function(){var e=this;if(this.selections){var n=this.selectFilterCtrl.value;if(n){var t=this.selections.filter(function(t){return!e.searchFields.every(function(e){return!t[e]||!t[e].toLowerCase().includes(n.toLowerCase())})});this.filteredSelections.next(t)}else this.filteredSelections.next(this.selections.slice())}},e}(),E=l.Va({encapsulation:0,styles:[[""]],data:{}});function U(e){return l.rb(0,[(e()(),l.Oa(0,null,null,0))],null,null)}function F(e){return l.rb(0,[(e()(),l.Xa(0,0,null,null,3,"mat-option",[["class","mat-option"],["role","option"]],[[1,"tabindex",0],[2,"mat-selected",null],[2,"mat-option-multiple",null],[2,"mat-active",null],[8,"id",0],[1,"aria-selected",0],[1,"aria-disabled",0],[2,"mat-option-disabled",null]],[[null,"click"],[null,"keydown"]],function(e,n,t){var i=!0;return"click"===n&&(i=!1!==l.hb(e,1)._selectViaInteraction()&&i),"keydown"===n&&(i=!1!==l.hb(e,1)._handleKeydown(t)&&i),i},y.c,y.a)),l.Wa(1,8568832,[[8,4]],0,k.t,[l.l,l.i,[2,k.l],[2,k.s]],null,null),(e()(),l.Oa(16777216,null,0,1,null,U)),l.Wa(3,540672,null,0,x.t,[l.U],{ngTemplateOutlet:[0,"ngTemplateOutlet"]},null)],function(e,n){e(n,3,0,n.component.unselectOptionTemplate)},function(e,n){e(n,0,0,l.hb(n,1)._getTabIndex(),l.hb(n,1).selected,l.hb(n,1).multiple,l.hb(n,1).active,l.hb(n,1).id,l.hb(n,1).selected.toString(),l.hb(n,1).disabled.toString(),l.hb(n,1).disabled)})}function j(e){return l.rb(0,[(e()(),l.Xa(0,0,null,null,2,"mat-option",[["class","mat-option"],["role","option"]],[[1,"tabindex",0],[2,"mat-selected",null],[2,"mat-option-multiple",null],[2,"mat-active",null],[8,"id",0],[1,"aria-selected",0],[1,"aria-disabled",0],[2,"mat-option-disabled",null]],[[null,"click"],[null,"keydown"]],function(e,n,t){var i=!0;return"click"===n&&(i=!1!==l.hb(e,1)._selectViaInteraction()&&i),"keydown"===n&&(i=!1!==l.hb(e,1)._handleKeydown(t)&&i),i},y.c,y.a)),l.Wa(1,8568832,[[8,4]],0,k.t,[l.l,l.i,[2,k.l],[2,k.s]],null,null),(e()(),l.pb(-1,0,[" <None> "]))],null,function(e,n){e(n,0,0,l.hb(n,1)._getTabIndex(),l.hb(n,1).selected,l.hb(n,1).multiple,l.hb(n,1).active,l.hb(n,1).id,l.hb(n,1).selected.toString(),l.hb(n,1).disabled.toString(),l.hb(n,1).disabled)})}function N(e){return l.rb(0,[(e()(),l.Oa(0,null,null,0))],null,null)}function X(e){return l.rb(0,[(e()(),l.Xa(0,0,null,null,4,"mat-option",[["class","mat-option"],["role","option"]],[[1,"tabindex",0],[2,"mat-selected",null],[2,"mat-option-multiple",null],[2,"mat-active",null],[8,"id",0],[1,"aria-selected",0],[1,"aria-disabled",0],[2,"mat-option-disabled",null]],[[null,"click"],[null,"keydown"]],function(e,n,t){var i=!0;return"click"===n&&(i=!1!==l.hb(e,1)._selectViaInteraction()&&i),"keydown"===n&&(i=!1!==l.hb(e,1)._handleKeydown(t)&&i),i},y.c,y.a)),l.Wa(1,8568832,[[8,4]],0,k.t,[l.l,l.i,[2,k.l],[2,k.s]],{value:[0,"value"]},null),(e()(),l.Oa(16777216,null,0,2,null,N)),l.Wa(3,540672,null,0,x.t,[l.U],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null),l.kb(4,{item:0})],function(e,n){var t=n.component;e(n,1,0,t.valueField?n.context.$implicit[t.valueField]:n.context.$implicit),e(n,3,0,e(n,4,0,n.context.$implicit),t.optionTemplate)},function(e,n){e(n,0,0,l.hb(n,1)._getTabIndex(),l.hb(n,1).selected,l.hb(n,1).multiple,l.hb(n,1).active,l.hb(n,1).id,l.hb(n,1).selected.toString(),l.hb(n,1).disabled.toString(),l.hb(n,1).disabled)})}function q(e){return l.rb(0,[(e()(),l.Xa(0,0,null,null,32,"mat-form-field",[["class","pad-left pad-right block mat-form-field"]],[[2,"mat-form-field-appearance-standard",null],[2,"mat-form-field-appearance-fill",null],[2,"mat-form-field-appearance-outline",null],[2,"mat-form-field-appearance-legacy",null],[2,"mat-form-field-invalid",null],[2,"mat-form-field-can-float",null],[2,"mat-form-field-should-float",null],[2,"mat-form-field-hide-placeholder",null],[2,"mat-form-field-disabled",null],[2,"mat-form-field-autofilled",null],[2,"mat-focused",null],[2,"mat-accent",null],[2,"mat-warn",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null],[2,"_mat-animation-noopable",null]],null,null,I.b,I.a)),l.Wa(1,7389184,null,7,L.c,[l.l,l.i,[2,k.j],[2,C.c],[2,L.a],w.a,l.C,[2,T.a]],null,null),l.nb(335544320,1,{_control:0}),l.nb(335544320,2,{_placeholderChild:0}),l.nb(335544320,3,{_labelChild:0}),l.nb(603979776,4,{_errorChildren:1}),l.nb(603979776,5,{_hintChildren:1}),l.nb(603979776,6,{_prefixChildren:1}),l.nb(603979776,7,{_suffixChildren:1}),(e()(),l.Xa(9,0,null,1,23,"mat-select",[["class","mat-select"],["disableOptionCentering",""],["role","listbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null],[1,"id",0],[1,"tabindex",0],[1,"aria-label",0],[1,"aria-labelledby",0],[1,"aria-required",0],[1,"aria-disabled",0],[1,"aria-invalid",0],[1,"aria-owns",0],[1,"aria-multiselectable",0],[1,"aria-describedby",0],[1,"aria-activedescendant",0],[2,"mat-select-disabled",null],[2,"mat-select-invalid",null],[2,"mat-select-required",null]],[[null,"ngModelChange"],[null,"keydown"],[null,"focus"],[null,"blur"]],function(e,n,t){var i=!0,a=e.component;return"keydown"===n&&(i=!1!==l.hb(e,14)._handleKeydown(t)&&i),"focus"===n&&(i=!1!==l.hb(e,14)._onFocus()&&i),"blur"===n&&(i=!1!==l.hb(e,14)._onBlur()&&i),"ngModelChange"===n&&(i=!1!==(a.selected=t)&&i),i},O.b,O.a)),l.mb(6144,null,k.l,null,[S.c]),l.Wa(11,540672,null,0,D.h,[[8,null],[8,null],[8,null],[2,D.D]],{form:[0,"form"],model:[1,"model"]},{update:"ngModelChange"}),l.mb(2048,null,D.q,null,[D.h]),l.Wa(13,16384,null,0,D.r,[[4,D.q]],null,null),l.Wa(14,2080768,null,3,S.c,[M.e,l.i,l.C,k.d,l.l,[2,C.c],[2,D.t],[2,D.k],[2,L.c],[6,D.q],[8,null],S.a],{placeholder:[0,"placeholder"],disableOptionCentering:[1,"disableOptionCentering"]},null),l.nb(603979776,8,{options:1}),l.nb(603979776,9,{optionGroups:1}),l.nb(335544320,10,{customTrigger:0}),l.mb(2048,[[1,4]],L.d,null,[S.c]),(e()(),l.Xa(19,0,null,1,6,"ngx-mat-select-search",[["noEntriesFoundLabel","Not found"],["placeholderLabel","Search"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],null,null,V.b,V.a)),l.Wa(20,4440064,null,1,A.a,[S.c,l.i],{placeholderLabel:[0,"placeholderLabel"],noEntriesFoundLabel:[1,"noEntriesFoundLabel"]},null),l.nb(335544320,11,{clearIcon:0}),l.mb(1024,null,D.p,function(e){return[e]},[A.a]),l.Wa(23,540672,null,0,D.h,[[8,null],[8,null],[6,D.p],[2,D.D]],{form:[0,"form"]},null),l.mb(2048,null,D.q,null,[D.h]),l.Wa(25,16384,null,0,D.r,[[4,D.q]],null,null),(e()(),l.Oa(16777216,null,1,1,null,F)),l.Wa(27,16384,null,0,x.m,[l.U,l.R],{ngIf:[0,"ngIf"]},null),(e()(),l.Oa(16777216,null,1,1,null,j)),l.Wa(29,16384,null,0,x.m,[l.U,l.R],{ngIf:[0,"ngIf"]},null),(e()(),l.Oa(16777216,null,1,2,null,X)),l.Wa(31,278528,null,0,x.l,[l.U,l.R,l.v],{ngForOf:[0,"ngForOf"]},null),l.jb(131072,x.b,[l.i])],function(e,n){var t=n.component;e(n,11,0,t.selectCtrl,t.selected),e(n,14,0,t.placeholder,""),e(n,20,0,"Search","Not found"),e(n,23,0,t.selectFilterCtrl),e(n,27,0,t.unselectOptionTemplate),e(n,29,0,t.showUndefinedOption&&!t.unselectOptionTemplate),e(n,31,0,l.qb(n,31,0,l.hb(n,32).transform(t.filteredSelections)))},function(e,n){e(n,0,1,["standard"==l.hb(n,1).appearance,"fill"==l.hb(n,1).appearance,"outline"==l.hb(n,1).appearance,"legacy"==l.hb(n,1).appearance,l.hb(n,1)._control.errorState,l.hb(n,1)._canLabelFloat,l.hb(n,1)._shouldLabelFloat(),l.hb(n,1)._hideControlPlaceholder(),l.hb(n,1)._control.disabled,l.hb(n,1)._control.autofilled,l.hb(n,1)._control.focused,"accent"==l.hb(n,1).color,"warn"==l.hb(n,1).color,l.hb(n,1)._shouldForward("untouched"),l.hb(n,1)._shouldForward("touched"),l.hb(n,1)._shouldForward("pristine"),l.hb(n,1)._shouldForward("dirty"),l.hb(n,1)._shouldForward("valid"),l.hb(n,1)._shouldForward("invalid"),l.hb(n,1)._shouldForward("pending"),!l.hb(n,1)._animationsEnabled]),e(n,9,1,[l.hb(n,13).ngClassUntouched,l.hb(n,13).ngClassTouched,l.hb(n,13).ngClassPristine,l.hb(n,13).ngClassDirty,l.hb(n,13).ngClassValid,l.hb(n,13).ngClassInvalid,l.hb(n,13).ngClassPending,l.hb(n,14).id,l.hb(n,14).tabIndex,l.hb(n,14)._getAriaLabel(),l.hb(n,14)._getAriaLabelledby(),l.hb(n,14).required.toString(),l.hb(n,14).disabled.toString(),l.hb(n,14).errorState,l.hb(n,14).panelOpen?l.hb(n,14)._optionIds:null,l.hb(n,14).multiple,l.hb(n,14)._ariaDescribedby||null,l.hb(n,14)._getAriaActiveDescendant(),l.hb(n,14).disabled,l.hb(n,14).errorState,l.hb(n,14).required]),e(n,19,0,l.hb(n,25).ngClassUntouched,l.hb(n,25).ngClassTouched,l.hb(n,25).ngClassPristine,l.hb(n,25).ngClassDirty,l.hb(n,25).ngClassValid,l.hb(n,25).ngClassInvalid,l.hb(n,25).ngClassPending)})}var z=t("jTJ4"),H=t("c714"),B=t("wm4d"),G=t("Olm7"),K=t("cmJY"),Y=t("BCsM"),Z=t("D8hx"),$=t("Cmri"),Q=t("Wy0B"),ee=function(){function e(e,n,t){var i=this;this._plannerData=e,this._dialog=n,this._toast=t,this.jobsAddedToVehicle=new l.n,this.tableHeight=800,this.itemActions=[{tooltip:"Open",icon:"launch",click:function(e){return i._dialog.openOrderDetailById(e.DeliveryMasterId)}}],this.left={vehicle:void 0,data:[],selected:[],column:Q.b,selectActions:[{label:"Move Up",icon:"file_upload",click:function(e){return i._moveJobsUpOrDown(i.left,e,!0)}},{label:"Move Down",icon:"file_download",click:function(e){return i._moveJobsUpOrDown(i.left,e,!1)}},{label:"Move to Right",icon:"fast_forward",click:function(e){return i._moveJobsLeftorRight(i.left,i.right,e)}}]},this.right={vehicle:void 0,data:[],selected:[],column:Q.b,selectActions:[{label:"Move Up",icon:"file_upload",click:function(e){return i._moveJobsUpOrDown(i.right,e,!0)}},{label:"Move Down",icon:"file_download",click:function(e){return i._moveJobsUpOrDown(i.right,e,!1)}},{label:"Move to Left",icon:"fast_rewind",click:function(e){return i._moveJobsLeftorRight(i.right,i.left,e)}}]}}return e.prototype.onResize=function(e){void 0===e&&(e=void 0),this.tableHeight=window.innerHeight-190},e.prototype.ngOnInit=function(){this.onResize()},e.prototype.ngOnChanges=function(e){console.log("PlannerDispatchComponent -> ngOnChanges -> changes",e),e.unassignedJobMarkers.firstChange&&(this.left.vehicle=this.selectedVehicle||this.vehicles[0]),this._originalUnasignedJobMarkers=this.unassignedJobMarkers.map(function(e){return e}),this.updateTable(this.left),this.updateTable(this.right)},e.prototype.getAndUpdateTable=function(e){e.vehicle=this.vehicles.find(function(n){return n.Id===e.selectedId}),this.updateTable(e)},e.prototype.updateTable=function(e){if(e.data=[],e.vehicle){if(e.vehicle.route){var n=e.vehicle.route.markers;n&&n.length>0&&(e.data=n.map(function(e){return e.tags}))}}else e.data=this.unassignedJobMarkers.map(function(e){return e.tags})},e.prototype._moveJobsUpOrDown=function(e,n,t){var l=n.map(function(e){return e.DeliveryMasterId});if(K.a.containFinishedJob(n))return this._handleFinishedJobs(n),!0;if(!e.vehicle)return!0;if(!this._isEnoughRoomToMove(e.data,n,t))return this._dialog.error("PLANNER_DISPATCH.MAX_LIMIT_ERROR"),!0;if(!this._isShipmentConstraintSatisfy(e.data,n,t))return this._dialog.error("PLANNER_DISPATCH.SHIPMENT_ORDER_ERROR"),!0;var i=e.vehicle.route;if(i&&n){if(this._sortJobArraysBasedOnIndex(n,e.data),t)for(var a=0;a<n.length;a++){var o=e.data.indexOf(n[a]);i.swapMarkers(o,o-1)}else for(a=n.length-1;a>=0;a--)o=e.data.indexOf(n[a]),i.swapMarkers(o,o+1);i.isChanged=!0,i.updateLatLngs(),this.updateTable(e),this._toast.shortAlert(this._getMovedOrdersLabel(l)+" have been moved "+(t?"up":"down")),this._notifyChanges()}return!0},e.prototype._moveJobsLeftorRight=function(e,n,t){var l,i=t.map(function(e){return e.DeliveryMasterId}),a=e.data.filter(function(e){return i.includes(e.DeliveryMasterId)});if(this._sortJobArraysBasedOnIndex(a,e.data),K.a.containFinishedJob(a))return this._handleFinishedJobs(a),!0;var o=[];if(e.vehicle&&!n.vehicle){var r=this._removeJobsFromVehicle(e.vehicle,a);(l=this.unassignedJobMarkers).push.apply(l,r),this.updateTable(e),this.updateTable(n),this._toast.shortAlert(this._getMovedOrdersLabel(i)+" have been removed from "+e.vehicle.Id)}else e.vehicle&&n.vehicle?(r=this._removeJobsFromVehicle(e.vehicle,a),this._addJobsToVehicle(n.vehicle,r),this.updateTable(e),this.updateTable(n),this._toast.shortAlert(this._getMovedOrdersLabel(i)+" have been moved from "+e.vehicle.Id+" to "+n.vehicle.Id)):!e.vehicle&&n.vehicle&&(o=i,r=this._removeJobsFromUnassignedJobs(a),this._addJobsToVehicle(n.vehicle,r),this.updateTable(e),this.updateTable(n),this._toast.shortAlert(this._getMovedOrdersLabel(i)+" have been added to "+n.vehicle.Id));return this._notifyChanges(o),!1},e.prototype._getMovedOrdersLabel=function(e){return e.length<=2?e.join(", "):e.length+" orders"},e.prototype._removeJobsFromVehicle=function(e,n){var t=e.route,l=t.markers.filter(function(e){return n.includes(e.tags)});return console.log("PlannerDispatchComponent -> movedMarkers",l),l.length>0&&(l.forEach(function(e){t.removeMarker(e)}),t.isChanged=!0,t.updateLatLngs()),l},e.prototype._addJobsToVehicle=function(e,n){console.log("_addJobsToVehicle",e,n),n.length>0&&(this.jobsAddedToVehicle.emit({vehicle:e,markers:n}),e.route.isChanged=!0)},e.prototype._removeJobsFromUnassignedJobs=function(e){return Object(G.a)(this.unassignedJobMarkers,function(n){return e.includes(n.tags)})},e.prototype._isEnoughRoomToMove=function(e,n,t){return n.every(function(n,l){var i=e.indexOf(n);return!!(t&&i>=1)||!t&&i<=e.length-2})},e.prototype._isShipmentConstraintSatisfy=function(e,n,t){return n.every(function(l,i){var a=e.indexOf(l);if(t&&K.a.isJobDelivery(l)&&a>=1){var o=e[a-1];return!(o.DeliveryMasterId===l.DeliveryMasterId&&K.a.isJobPickup(o)&&!n.includes(o))}if(!t&&K.a.isJobPickup(l)&&a<=e.length-2){var r=e[a+1];return!(r.DeliveryMasterId===l.DeliveryMasterId&&K.a.isJobDelivery(r)&&!n.includes(r))}return!0})},e.prototype._notifyChanges=function(e){var n=this;void 0===e&&(e=[]);var t=this.vehicles.filter(function(e){return e.route&&e.route.isChanged}).map(function(e){return e.route}),l=this.unassignedJobMarkers.filter(function(e){return!n._originalUnasignedJobMarkers.includes(e)}).map(function(e){return e.tags.DeliveryMasterId});this._plannerData.onPlanChanged.next({routes:t,unassignedOrderIds:l,movedOrderIds:e})},e.prototype._sortJobArraysBasedOnIndex=function(e,n){e.length>=2&&e.sort(function(e,t){return n.indexOf(e)-n.indexOf(t)})},e.prototype._handleFinishedJobs=function(e){var n=K.a.getFinishedJobs(e);this._dialog.alert("PLANNER_DISPATCH.FINISHED_JOBS_MSG","Alert",n)},e}(),ne=l.Va({encapsulation:0,styles:[[".left-panel[_ngcontent-%COMP%]{border-right:4px solid rgba(0,0,0,.12)}"]],data:{}});function te(e){return l.rb(0,[(e()(),l.Oa(0,null,null,0))],null,null)}function le(e){return l.rb(0,[(e()(),l.Oa(0,null,null,0))],null,null)}function ie(e){return l.rb(0,[(e()(),l.Xa(0,0,null,null,9,"div",[["layout","column"]],null,null,null,null,null)),(e()(),l.Xa(1,0,null,null,2,"vrp-search-select",[],null,[[null,"selectedChange"]],function(e,n,t){var l=!0,i=e.component;return"selectedChange"===n&&(l=!1!==(e.context.table.vehicle=t)&&l),"selectedChange"===n&&(l=!1!==i.updateTable(e.context.table)&&l),l},q,E)),l.Wa(2,770048,null,0,W,[],{optionTemplate:[0,"optionTemplate"],unselectOptionTemplate:[1,"unselectOptionTemplate"],selections:[2,"selections"],searchFields:[3,"searchFields"],placeholder:[4,"placeholder"],selected:[5,"selected"]},{selectedChange:"selectedChange"}),l.ib(3,2),(e()(),l.Xa(4,0,null,null,5,"vrp-table",[["flex",""],["sortable","false"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],function(e,n,t){var l=!0;return"ngModelChange"===n&&(l=!1!==(e.context.table.selected=t)&&l),l},z.b,z.a)),l.Wa(5,573440,null,0,H.a,[B.a],{columns:[0,"columns"],data:[1,"data"],selectActions:[2,"selectActions"],itemActions:[3,"itemActions"],sortable:[4,"sortable"],tableHeight:[5,"tableHeight"]},null),l.mb(1024,null,D.p,function(e){return[e]},[H.a]),l.Wa(7,671744,null,0,D.u,[[8,null],[8,null],[8,null],[6,D.p]],{model:[0,"model"]},{update:"ngModelChange"}),l.mb(2048,null,D.q,null,[D.u]),l.Wa(9,16384,null,0,D.r,[[4,D.q]],null,null)],function(e,n){var t=n.component;e(n,2,0,l.hb(n.parent,10),l.hb(n.parent,11),t.vehicles,e(n,3,0,"Id","DriverUsername"),n.context.table.vehicle?"Select Vehicle":"Unassigned Jobs ("+t.unassignedJobMarkers.length+")",n.context.table.vehicle),e(n,5,0,n.context.table.column,n.context.table.data,n.context.table.selectActions,t.itemActions,"false",t.tableHeight),e(n,7,0,n.context.table.selected)},function(e,n){e(n,4,0,l.hb(n,9).ngClassUntouched,l.hb(n,9).ngClassTouched,l.hb(n,9).ngClassPristine,l.hb(n,9).ngClassDirty,l.hb(n,9).ngClassValid,l.hb(n,9).ngClassInvalid,l.hb(n,9).ngClassPending)})}function ae(e){return l.rb(0,[(e()(),l.pb(0,null,[" "," - "," (",") - "," jobs\n"]))],null,function(e,n){e(n,0,0,n.context.item.UserGroup?n.context.item.UserGroup:"<None>",n.context.item.Id,n.context.item.DriverUsername,n.context.item.route?n.context.item.route.markers.length:0)})}function oe(e){return l.rb(0,[(e()(),l.pb(0,null,[" Unassigned jobs (",")\n"]))],null,function(e,n){e(n,0,0,n.component.unassignedJobMarkers.length)})}function re(e){return l.rb(0,[(e()(),l.Xa(0,0,null,null,8,"div",[["layout","row"]],null,null,null,null,null)),(e()(),l.Xa(1,0,null,null,3,"div",[["class","left-panel"],["flex","50"]],null,null,null,null,null)),(e()(),l.Oa(16777216,null,null,2,null,te)),l.Wa(3,540672,null,0,x.t,[l.U],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null),l.kb(4,{table:0}),(e()(),l.Xa(5,0,null,null,3,"div",[["class","right-panel"],["flex","50"]],null,null,null,null,null)),(e()(),l.Oa(16777216,null,null,2,null,le)),l.Wa(7,540672,null,0,x.t,[l.U],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null),l.kb(8,{table:0}),(e()(),l.Oa(0,[["vehicleSelectionTemplate",2]],null,0,null,ie)),(e()(),l.Oa(0,[["vehicleSelectionOptionTemplate",2]],null,0,null,ae)),(e()(),l.Oa(0,[["vehicleUnSelectionOptionTemplate",2]],null,0,null,oe))],function(e,n){var t=n.component;e(n,3,0,e(n,4,0,t.left),l.hb(n,9)),e(n,7,0,e(n,8,0,t.right),l.hb(n,9))},null)}var se=t("c4Wm"),ue=t("Nsh5"),ce=t("lLAP"),de=t("f4TD"),he=t("N1KZ"),be=t("G1cW"),pe=t("xrix"),fe=t("+gH2"),ge=t("bujt"),me=t("v9Dh"),ve=t("eDkP"),_e=t("UodH"),ye=t("Mr+X"),ke=t("SMsm"),xe=t("sA4U"),Ie=t("bTcF"),Le=t("auuj"),Ce=t("vsvT"),we=t("mrSG"),Te=Q.l.map(function(e){return e.color}),Oe=function(e){function n(n){var t=e.call(this,[n.lat||n.Lat,n.lng||n.Lng||n.lon||n.Lon],{riseOnHover:!0})||this;return t._datePipe=new x.e("en-US"),t.category="job",t.type="marker",t.active=!1,t.tags=n,t.updateMarker(),t.on("click",function(e){return t.active=!0}),t}return Object(we.__extends)(n,e),n.prototype.getStatus=function(){return this.tags.VehicleId?this.tags.Status:6},n.prototype.getStatusLabel=function(){return Q.m[this.getStatus()]},n.prototype.compareWith=function(e){var n=this.tags.ActualDeliveryTime,t=e.tags.ActualDeliveryTime;return n&&t?new Date(n).getTime()-new Date(t).getTime():n&&!t?-1:!n&&t?1:this.tags.EngineRouteSeqNum-e.tags.EngineRouteSeqNum},n.prototype.updateMarker=function(){var e=this;this.normalIcon=function(n){return void 0===n&&(n=void 0),Ie.a.createHtmlMarkerIcon(n,Te[e.getStatus()],n?40:20)},this.bindPopup(this._getHtmlPopupContent()),this.setNormalIcon()},n.prototype.toString=function(){return this.tags.JobType+" - #"+this.tags.DeliveryMasterId},n.prototype._getHtmlPopupContent=function(){var e=this.tags,n=""+["Id","ContactName","Address","Postal","DeliveryMasterId","EngineRouteSeqNum"].filter(function(n){return e}).map(function(n){return"<span class='popupMsgLine'><b>"+n.replace(/([A-Z])/g," $1")+": </b>"+e[n]+"</span><br>"}).join("");n+="<span class='popupMsgLine'><b>Status: </b>"+this.getStatusLabel()+"</span><br>";try{var t=this._datePipe.transform(e.StartTimeWindow,"shortTime"),l=this._datePipe.transform(e.EndTimeWindow,"shortTime");n+="<b>"+e.JobType+":</b> ("+t+"-"+l+") - "+(e.VehicleId||"unassigned")+"<br>"}catch(n){console.error(e)}return e.ActualDeliveryTime&&(n+="<b>served on:</b>"+this._datePipe.transform(e.ActualDeliveryTime,"shortTime")+"<br>"),n+"<b>Coordinates:</b> "+this.getLatLng().lat.toFixed(3)+","+this.getLatLng().lng.toFixed(3)},n}(Ie.b),Se=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return Object(we.__extends)(n,e),n.prototype.removeMarker=function(n){var t=e.prototype.removeMarker.call(this,n);return t&&(n.tags.VehicleId=void 0,n.updateMarker()),t},n.prototype.insertMarkers=function(n){var t=this;e.prototype.insertMarkers.call(this,n),n.forEach(function(e){e.tags.VehicleId=t.id,e.updateMarker()})},n.prototype.toCSVData=function(e){var n=this;void 0===e&&(e=!0);var t=[];return e&&t.push(Q.o),this.markers.forEach(function(e,l){var i=e.tags,a=new Date(i.StartTimeWindow).toLocaleTimeString(),o=new Date(i.EndTimeWindow).toLocaleTimeString(),r=i.ActualDeliveryTime?new Date(i.ActualDeliveryTime).toLocaleTimeString():"";t.push([n.id,l,i.DeliveryMasterId,i.JobType,i.Address,i.ContactName,a,o,r,e.getStatusLabel()])}),t},n.prototype.toMongoJSON=function(){var e=this.markers.filter(function(e){return 1===e.getStatus()||5===e.getStatus()}).map(function(e){return{job_id:e.tags.DeliveryMasterId,type:e.tags.JobType.toLowerCase()}});return{vehicle_id:this.id,act:e}},n.prototype._getHtmlPopupContent=function(){return"<b>Vehicle Id:</b> "+this.id},n}(t("6tJI").a),De=function(e){function n(n,t){var l=e.call(this,[n.LastSeen.Lat,n.LastSeen.Lng],{riseOnHover:!0})||this;return l._datePipe=new x.e("en-US"),l.category="vehicle",l.type="marker",l.color=t||Ie.a.getRandomColor(),l.tags=n,l.bindTooltip(""+l.tags.Id,{permanent:!0,direction:"bottom",offset:[0,0]}),l.bindPopup(""),l.updateMarker(),l}return Object(we.__extends)(n,e),n.prototype.updateMarker=function(){var e=this;this.normalIcon=function(){return Ie.a.createTruckMarkerIcon(e.color)},this.setTooltipContent(""+this.tags.Id),this.setPopupContent(this._getHtmlPopupContent()),this.setNormalIcon()},n.prototype._getHtmlPopupContent=function(){var e=this.tags,n=""+["Id","DriverUsername","PlateNumber"].filter(function(n){return e[n]}).map(function(n){return"<span class='popupMsgLine'><b>"+n+": </b>"+e[n]+"</span><br>"}).join("");try{e.LastSeen&&(n+="<span class='popupMsgLine'><b>Last Seen: </b>"+this._datePipe.transform(e.LastSeen.RecordedTime,"yyyy-MM-dd HH:mm")+"</span><br>")}catch(n){console.error(e)}return(n+="<b>Time Window:</b> "+e.StartTime+" - "+e.EndTime+"<br>")+"<b>Coordinates:</b> "+this.getLatLng().lat.toFixed(3)+","+this.getLatLng().lng.toFixed(3)},n}(Ie.b),Me=function(){function e(e,n,t,l,i,a){var o=this;this._route=e,this._dialog=n,this._socket=t,this._plannerRest=l,this._plannerData=i,this._excel=a,this._subscriptions=[],this.timeFilter={start:"",end:""},this.statusColors=Q.l.map(function(e){return e.primary}),this.legends=[{className:"blank-marker-icon truck-red",text:"Vehicles",checked:!0,toggle:function(e){return o._toggleLegend(e)}},{className:"blank-marker-icon blue",text:"Pending",checked:!0,toggle:function(e){return o._toggleLegend(e)}},{className:"blank-marker-icon orange",text:"Late",checked:!0,toggle:function(e){return o._toggleLegend(e)}},{className:"blank-marker-icon green",text:"Ontime",checked:!0,toggle:function(e){return o._toggleLegend(e)}},{className:"blank-marker-icon red",text:"Unsuccesful",checked:!0,toggle:function(e){return o._toggleLegend(e)}},{className:"blank-marker-icon magenta",text:"Expected Late",checked:!0,toggle:function(e){return o._toggleLegend(e)}},{className:"blank-marker-icon grey",text:"Unassigned",checked:!1,toggle:function(e){return o._toggleLegend(e)}},{className:"blank-marker-icon station",text:"Stations",checked:!0,toggle:function(e){return o._toggleLegend(e)}}],this.vehicles=[],this.unassignedJobMarkers=[],this.navSettings={},this.navData=[],this.vehicleListSettings={title:"Vehicles",selected:[],filter:function(e,n){return(""+n.id+n.DriverUsername).search(new RegExp(e,"i"))>-1},headerMenuActions:[{label:"Export Plan",icon:"file_download",click:function(e){return o._exportPlanToExcel()}}],itemTemplateRef:function(){return o.vehicleItemTemplate},itemMenuActions:[{label:"Open",icon:"launch",click:function(e){return o.openVehicle(e)}},{label:"Edit Job Sequence",icon:"edit",click:function(e){o.clickedVehicle=e,o.toggleDispatchPanel(!0)}},{label:"Export to Excel",icon:"file_download",click:function(e){return o._exportPlanToExcel(e)}}],itemClick:function(e){e.checked&&e.route&&(e.route.highlight(!0),o.clickedVehicle=e)},itemSelect:function(e,n){o.visualizeVehicle(e),e.checked&&e.route&&!n&&e.route.highlight(!0)}},this.actListSettings={title:"Activities",numbering:!0,headerActions:[{label:"Go back",icon:"arrow_back",click:function(){return o.openVehicle()}}],filter:function(e,n){return(""+n.tags.DeliveryMasterId).search(new RegExp(e,"i"))>-1},itemTemplateRef:function(){return o.actItemTemplate},itemClick:function(e){return e.openPopup()}},this.innerHeight=500,this._plannerData.addListeners(["DeliveryDetail","Vehicle"])}return e.prototype.onResize=function(e){void 0===e&&(e=void 0),this.innerHeight=window.innerHeight-65},e.prototype.ngOnInit=function(){var e=this;this.onResize(),this._route.queryParams.subscribe(function(n){if(n.timeFilter){var t=n.timeFilter.split("-");e.timeFilter={start:t[0],end:t[1]},e._filterJobMarkersByTime()}})},e.prototype.ngAfterViewInit=function(){var e=this,n=this._plannerData.Vehicle,t=this._plannerData.DeliveryDetail;this._subscriptions=[n.data$.subscribe(function(n){console.log("PlannerVehicleTrackingComponent -> Vehicle:get",n),n.forEach(function(n){if(n.DriverUsername){var t=e._getVehicle(n.Id);Object.assign(t,n)}})}),n.update$.subscribe(function(e){console.log("PlannerVehicleTrackingComponent -> Vehicle:update",e)}),t.data$.subscribe(function(n){console.log("PlannerVehicleTrackingComponent -> DeliveryDetail:get",n),setTimeout(function(){e.renderDelivers(n),e.updateUnassignedJobs()})}),t.update$.subscribe(function(n){console.log("PlannerVehicleTrackingComponent -> DeliveryDetail:update",n);var t=n.data.map(function(e){return e.Id}),l=e.vrpLeaflet.select(function(e){return e.tags&&t.includes(e.tags.Id)});"delete"===n.purpose?e.vrpLeaflet.removeLayers(l):l.forEach(function(e){return e.updateMarker()})}),this._plannerData.onPlanChanged.subscribe(function(n){e.updateUnassignedJobs()})],this.openVehicle(),this._plannerRest.getVehicleLastLocation().subscribe(function(n){console.log("PlannerVehicleTrackingComponent -> ngOnInit -> VehicleLocationLog:get",n),e._updateVehicleLocations(n)}),this._socket.onJSON("VehicleLocationLog",function(n){console.log("PlannerVehicleTrackingComponent -> ngOnInit -> VehicleLocationLog:update",n);try{e._updateVehicleLocations(n.data)}catch(e){console.error(e)}})},e.prototype.ngOnDestroy=function(){this.vrpLeaflet.highlightOff().removeAllLayers(),this._subscriptions.forEach(function(e){return e.unsubscribe()}),this._socket.removeListener("VehicleLocationLog"),this._plannerData.removeAllListeners()},e.prototype.renderDelivers=function(e){var n=this;if(this.vrpLeaflet){this.vrpLeaflet.highlightOff().removeAllLayers(),this.vehicles.forEach(function(e){e.marker=void 0,e.checked=!1,e.route=void 0});var t=[],l=e.map(function(e){return e.VehicleId&&!t.includes(e.VehicleId)&&t.push(e.VehicleId),new Oe(e)});this.vrpLeaflet.add(l),t.sort(),t.forEach(function(e){var t=n._getVehicle(e),i=l.filter(function(e){return e.tags.VehicleId===t.Id});i.length>0&&(n.addJobsToVehicleRoute(t,i),t.route.markers.sort(function(e,n){return e.compareWith(n)}),t.route.updateLatLngs())}),this._plannerRest.getVehicleLastLocation().subscribe(function(e){return n._updateVehicleLocations(e)}),this.openVehicle()}},e.prototype.openVehicle=function(e){var n=this;if(void 0===e&&(e=void 0),e){this.selectedVehicle=e,e.checked=!0;var t,l=e.route;this.vrpLeaflet&&this.vrpLeaflet.isInitialized&&l.highlight(),l.markers.forEach(function(e){e._subHeader=t&&t.Address===e.tags.Address&&t.JobType===e.tags.JobType?void 0:e.tags.JobType+" at "+e.tags.Address,t=e.tags}),this.navData=l.markers,this.navSettings=this.actListSettings,this.navSettings.title=e.Id}else this.selectedVehicle=void 0,this.vehicles&&(this.vehicles.sort(function(e,n){return e.Id.localeCompare(n.Id)}),this.navData=this.vehicles.filter(function(e){return e.route&&e.route.markers&&e.route.markers.length>0})||[]),this.navSettings=this.vehicleListSettings,this.navSettings.title="Vehicles",this.vrpLeaflet&&this.vrpLeaflet.isInitialized&&this.vrpLeaflet.highlightOff();this.vehicles&&this.vehicles.forEach(function(e){return n.visualizeVehicle(e)})},e.prototype.updateUnassignedJobs=function(){this.unassignedJobMarkers=this.vrpLeaflet.select(function(e){return e instanceof Oe&&!e.tags.VehicleId})},e.prototype.openOrderDetailDialog=function(e){this._dialog.openOrderDetailById(e,!1)},e.prototype.toggleDispatchPanel=function(e){e?(this.updateUnassignedJobs(),this.sideNavRight.open(),this._plannerData.dispatchPanelToggled$.next(this.sideNavRight.opened)):(this.sideNavRight.close(),this.selectedVehicle?this.visualizeVehicle(this.selectedVehicle):this.navData=this.vehicles&&this.vehicles.filter(function(e){return e.route&&e.route.markers&&e.route.markers.length>0})||[],this._plannerData.dispatchPanelToggled$.next(this.sideNavRight.opened))},e.prototype.onJobsAddedToVehicle=function(e){var n=this._getVehicle(e.vehicle.Id);this.addJobsToVehicleRoute(n,e.markers)},e.prototype.addJobsToVehicleRoute=function(e,n){if(e)if(n.forEach(function(n){return n.tags.VehicleId=e.Id}),e.route)e.route.insertMarkers(n);else{var t=new Ce.a(e.Id,e.color,{address:{lat:e.StartAddressLat,lng:e.StartAddressLng,postal:e.StartAddressPostal}}),l=void 0;e.ReturnToEndAddress&&(l=new Ce.a(e.Id,e.color,{address:{lat:e.EndAddressLat,lng:e.EndAddressLng,postal:e.EndAddressPostal}})),e.route=new Se(e.Id,t,n,l,e.color,void 0),this.vrpLeaflet.add([t,l,e.route])}},e.prototype.visualizeVehicle=function(e){var n=[];e.marker&&n.push(e.marker),e.route&&n.push.apply(n,[e.route].concat(e.route.markers,[e.route.startMarker,e.route.stopMarker])),this._toggleLayers(n,this.selectedVehicle?this.selectedVehicle===e:e.checked)},e.prototype._getVehicle=function(e){var n=this.vehicles.find(function(n){return n.Id===e});if(!n){var t=Ie.a.getRandomColor(this.vehicles.length);this.vehicles.push(n={Id:e,checked:!1,color:t})}return n},e.prototype._filterJobMarkersByTime=function(){var e=this,n=[],t=[];this.vrpLeaflet.select(function(e){return e instanceof Oe}).forEach(function(l){xe.c.isTimeWindowWithinRange(l.tags,e.timeFilter)?n.push(l):t.push(l)}),this._toggleLayers(n,!0),this._toggleLayers(t,!1)},e.prototype._exportPlanToExcel=function(e){void 0===e&&(e=void 0);var n="plan-"+this._plannerData.DeliveryDetail.queryObject.startDate.YYMMDD();if(e){if(e.route){var t=e.route.markers.map(function(e){return e.tags});this._excel.jsonToSingleSheetExcelFile(t,Q.g,"Plan",l=n+"-"+e.Id+".xlsx")}}else{var l=n+".xlsx",i=[];this.vehicles.filter(function(e){return e.route}).forEach(function(e){i.push.apply(i,e.route.markers.map(function(e){return e.tags}))}),this._excel.jsonToSingleSheetExcelFile(i,Q.g,"Plan",l)}},e.prototype._toggleLegend=function(e){var n;n=this.vrpLeaflet.select(0===e?function(e){return e instanceof De}:7===e?function(e){return e instanceof Ce.a}:function(n){return n instanceof Oe&&n.getStatus()===e}),this._toggleLayers(n,this.legends[e].checked)},e.prototype._updateVehicleMarker=function(e){e.LastSeen&&(e.marker?(e.marker.tags=e,e.marker.setLatLng([e.LastSeen.Lat,e.LastSeen.Lng]),e.marker.updateMarker()):(e.marker=new De(e,e.color),this.vrpLeaflet.add(e.marker)),this.vrpLeaflet.toggleLayers([e.marker],e.checked&&this.legends[0].checked))},e.prototype._updateVehicleLocations=function(e){var n=this;e&&e.forEach(function(e){if(n.vehicles.find(function(n){return n.Id===e.VehicleId&&n.DriverUsername})){var t=n._getVehicle(e.VehicleId);t&&(t.LastSeen=e,n._updateVehicleMarker(t))}})},e.prototype._toggleLayers=function(e,n){var t=this;if(n){var l=this.selectedVehicle?[this.selectedVehicle.Id]:this.vehicles.filter(function(e){return e.checked}).map(function(e){return e.Id}),i=e.filter(function(e){if(e instanceof Oe){if(xe.c.isTimeWindowWithinRange(e.tags,t.timeFilter)&&t.legends[e.getStatus()].checked)return!e.tags.VehicleId||l.includes(e.tags.VehicleId)}else{if(e instanceof De)return t.legends[0].checked&&l.includes(e.tags.Id);if(e instanceof Ce.a)return t.legends[7].checked&&l.includes(e.routeId);if(e instanceof Se)return l.includes(e.id)}return!1});this.vrpLeaflet.showLayers(i)}else this.vrpLeaflet.hideLayers(e)},e}(),Ve=t("ZYCi"),Ae=t("Z/yy"),Je=t("eDjj"),Pe=l.Va({encapsulation:0,styles:[[""]],data:{}});function Re(e){return l.rb(0,[(e()(),l.Xa(0,0,null,null,1,"vrp-planner-dispatch",[],null,[[null,"jobsAddedToVehicle"],["window","resize"]],function(e,n,t){var i=!0,a=e.component;return"window:resize"===n&&(i=!1!==l.hb(e,1).onResize(t)&&i),"jobsAddedToVehicle"===n&&(i=!1!==a.onJobsAddedToVehicle(t)&&i),i},re,ne)),l.Wa(1,638976,[["plannerDispatch",4]],0,ee,[Y.a,$.a,Z.a],{selectedVehicle:[0,"selectedVehicle"],vehicles:[1,"vehicles"],unassignedJobMarkers:[2,"unassignedJobMarkers"]},{jobsAddedToVehicle:"jobsAddedToVehicle"})],function(e,n){var t=n.component;e(n,1,0,t.selectedVehicle||t.clickedVehicle,t.vehicles,t.unassignedJobMarkers)},null)}function We(e){return l.rb(0,[(e()(),l.Xa(0,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),l.pb(1,null,["(",")"]))],null,function(e,n){e(n,1,0,n.parent.context.item.DriverUsername)})}function Ee(e){return l.rb(0,[(e()(),l.Xa(0,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),l.pb(1,null,[" "," jobs"]))],null,function(e,n){e(n,1,0,n.parent.context.item.route&&n.parent.context.item.route.markers.length)})}function Ue(e){return l.rb(0,[(e()(),l.Xa(0,0,null,null,3,"span",[],[[4,"color",null]],null,null,null,null)),(e()(),l.pb(1,null,[" "," "])),(e()(),l.Oa(16777216,null,null,1,null,We)),l.Wa(3,16384,null,0,x.m,[l.U,l.R],{ngIf:[0,"ngIf"]},null),(e()(),l.Xa(4,0,null,null,0,"br",[],null,null,null,null,null)),(e()(),l.Oa(16777216,null,null,1,null,Ee)),l.Wa(6,16384,null,0,x.m,[l.U,l.R],{ngIf:[0,"ngIf"]},null),(e()(),l.Oa(0,null,null,0))],function(e,n){e(n,3,0,n.context.item.DriverUsername),e(n,6,0,n.context.item.route)},function(e,n){e(n,0,0,n.context.item.color),e(n,1,0,n.context.item.Id)})}function Fe(e){return l.rb(0,[(e()(),l.Xa(0,0,null,null,4,"span",[],null,null,null,null,null)),(e()(),l.pb(-1,null,["finished at "])),(e()(),l.Xa(2,0,null,null,2,"span",[["class","tc-red-500"]],null,null,null,null,null)),(e()(),l.pb(3,null,["",""])),l.lb(4,2)],null,function(e,n){e(n,3,0,l.qb(n,3,0,e(n,4,0,l.hb(n.parent.parent,0),n.parent.context.item.tags.ActualDeliveryTime,"HH:mm")))})}function je(e){return l.rb(0,[(e()(),l.pb(-1,null,[" Order "])),(e()(),l.Xa(1,0,null,null,1,"a",[["href","javascript:;"]],[[4,"color",null]],[[null,"click"]],function(e,n,t){var l=!0;return"click"===n&&(l=!1!==e.component.openOrderDetailDialog(e.context.item.tags.DeliveryMasterId)&&l),l},null,null)),(e()(),l.pb(2,null,["#"," "])),(e()(),l.Xa(3,0,null,null,0,"br",[],null,null,null,null,null)),(e()(),l.Oa(16777216,null,null,1,null,Fe)),l.Wa(5,16384,null,0,x.m,[l.U,l.R],{ngIf:[0,"ngIf"]},null),(e()(),l.Oa(0,null,null,0))],function(e,n){e(n,5,0,n.context.item.tags.ActualDeliveryTime)},function(e,n){e(n,1,0,n.component.statusColors[n.context.item.tags.Status]),e(n,2,0,n.context.item.tags.DeliveryMasterId)})}function Ne(e){return l.rb(0,[l.jb(0,x.e,[l.x]),l.nb(402653184,1,{vehicleItemTemplate:0}),l.nb(402653184,2,{actItemTemplate:0}),l.nb(402653184,3,{vrpLeaflet:0}),l.nb(402653184,4,{navList:0}),l.nb(402653184,5,{sideNavRight:0}),(e()(),l.Xa(6,0,null,null,13,"mat-sidenav-container",[["class","mat-drawer-container mat-sidenav-container"]],[[4,"height","px"],[2,"mat-drawer-container-explicit-backdrop",null]],null,null,se.c,se.b)),l.Wa(7,1490944,null,2,ue.f,[[2,C.c],l.l,l.C,l.i,ue.a,[2,T.a]],null,null),l.nb(603979776,6,{_drawers:1}),l.nb(335544320,7,{_content:0}),(e()(),l.Xa(10,0,null,0,3,"mat-sidenav",[["class","mat-drawer mat-sidenav"],["mode","side"],["opened",""],["tabIndex","-1"]],[[40,"@transform",0],[1,"align",0],[2,"mat-drawer-end",null],[2,"mat-drawer-over",null],[2,"mat-drawer-push",null],[2,"mat-drawer-side",null],[2,"mat-sidenav-fixed",null],[4,"top","px"],[4,"bottom","px"]],[["component","@transform.start"],["component","@transform.done"]],function(e,n,t){var i=!0;return"component:@transform.start"===n&&(i=!1!==l.hb(e,11)._onAnimationStart(t)&&i),"component:@transform.done"===n&&(i=!1!==l.hb(e,11)._onAnimationEnd(t)&&i),i},se.d,se.a)),l.Wa(11,3325952,[[6,4],["sidenav",4]],0,ue.e,[l.l,ce.i,ce.h,w.a,l.C,[2,x.d]],{mode:[0,"mode"],opened:[1,"opened"]},null),(e()(),l.Xa(12,0,null,0,1,"vrp-nav-list",[],null,null,null,de.b,de.a)),l.Wa(13,638976,[[4,4],["navList",4]],0,he.a,[],{data:[0,"data"],settings:[1,"settings"]},null),(e()(),l.Xa(14,0,null,0,3,"mat-sidenav",[["class","mat-drawer mat-sidenav"],["disableClose",""],["mode","over"],["position","end"],["style","width:100%"],["tabIndex","-1"]],[[40,"@transform",0],[1,"align",0],[2,"mat-drawer-end",null],[2,"mat-drawer-over",null],[2,"mat-drawer-push",null],[2,"mat-drawer-side",null],[2,"mat-sidenav-fixed",null],[4,"top","px"],[4,"bottom","px"]],[[null,"closedStart"],["component","@transform.start"],["component","@transform.done"]],function(e,n,t){var i=!0;return"component:@transform.start"===n&&(i=!1!==l.hb(e,15)._onAnimationStart(t)&&i),"component:@transform.done"===n&&(i=!1!==l.hb(e,15)._onAnimationEnd(t)&&i),"closedStart"===n&&(i=!1!==l.hb(e,13).filter()&&i),i},se.d,se.a)),l.Wa(15,3325952,[[6,4],[5,4],["sideNavRight",4]],0,ue.e,[l.l,ce.i,ce.h,w.a,l.C,[2,x.d]],{position:[0,"position"],mode:[1,"mode"],disableClose:[2,"disableClose"]},{closedStart:"closedStart"}),(e()(),l.Oa(16777216,null,0,1,null,Re)),l.Wa(17,16384,null,0,x.m,[l.U,l.R],{ngIf:[0,"ngIf"]},null),(e()(),l.Xa(18,0,null,2,1,"vrp-leaflet",[],null,null,null,be.b,be.a)),l.Wa(19,4243456,[[3,4],["leafletMap",4]],0,pe.a,[fe.a],{legends:[0,"legends"]},null),(e()(),l.Xa(20,16777216,null,null,5,"a",[["class","mat-fab-bottom-right z-3 fixed fab-pad"],["color","accent"],["mat-fab",""],["matTooltipPosition","before"],["style","z-index:500"]],[[1,"tabindex",0],[1,"disabled",0],[1,"aria-disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"],[null,"longpress"],[null,"keydown"],[null,"touchend"]],function(e,n,t){var i=!0,a=e.component;return"longpress"===n&&(i=!1!==l.hb(e,21).show()&&i),"keydown"===n&&(i=!1!==l.hb(e,21)._handleKeydown(t)&&i),"touchend"===n&&(i=!1!==l.hb(e,21)._handleTouchend()&&i),"click"===n&&(i=!1!==l.hb(e,22)._haltDisabledEvents(t)&&i),"click"===n&&(i=!1!==a.toggleDispatchPanel(!l.hb(e,15).opened)&&i),i},ge.c,ge.a)),l.Wa(21,147456,null,0,me.d,[ve.c,l.l,M.c,l.U,l.C,w.a,ce.c,ce.h,me.b,[2,C.c],[2,me.a]],{position:[0,"position"],message:[1,"message"]},null),l.Wa(22,180224,null,0,_e.a,[w.a,ce.h,l.l,[2,T.a]],{color:[0,"color"]},null),(e()(),l.Xa(23,0,null,0,2,"mat-icon",[["class","mat-icon"],["role","img"]],[[2,"mat-icon-inline",null]],null,null,ye.b,ye.a)),l.Wa(24,638976,null,0,ke.a,[l.l,ke.c,[8,null]],null,null),(e()(),l.pb(25,0,["",""])),(e()(),l.Oa(0,[[1,2],["vehicleItemTemplate",2]],null,0,null,Ue)),(e()(),l.Oa(0,[[2,2],["actItemTemplate",2]],null,0,null,je))],function(e,n){var t=n.component;e(n,7,0),e(n,11,0,"side",""),e(n,13,0,t.navData,t.navSettings),e(n,15,0,"end","over",""),e(n,17,0,l.hb(n,15).opened),e(n,19,0,t.legends),e(n,21,0,"before",l.hb(n,15).opened?"Close Dispatch Panel":"Open Dispatch Panel"),e(n,22,0,"accent"),e(n,24,0)},function(e,n){e(n,6,0,n.component.innerHeight,l.hb(n,7)._backdropOverride),e(n,10,0,l.hb(n,11)._animationState,null,"end"===l.hb(n,11).position,"over"===l.hb(n,11).mode,"push"===l.hb(n,11).mode,"side"===l.hb(n,11).mode,l.hb(n,11).fixedInViewport,l.hb(n,11).fixedInViewport?l.hb(n,11).fixedTopGap:null,l.hb(n,11).fixedInViewport?l.hb(n,11).fixedBottomGap:null),e(n,14,0,l.hb(n,15)._animationState,null,"end"===l.hb(n,15).position,"over"===l.hb(n,15).mode,"push"===l.hb(n,15).mode,"side"===l.hb(n,15).mode,l.hb(n,15).fixedInViewport,l.hb(n,15).fixedInViewport?l.hb(n,15).fixedTopGap:null,l.hb(n,15).fixedInViewport?l.hb(n,15).fixedBottomGap:null),e(n,20,0,l.hb(n,22).disabled?-1:l.hb(n,22).tabIndex||0,l.hb(n,22).disabled||null,l.hb(n,22).disabled.toString(),"NoopAnimations"===l.hb(n,22)._animationMode),e(n,23,0,l.hb(n,24).inline),e(n,25,0,l.hb(n,15).opened?"close":"edit")})}var Xe=l.Ta("vrp-planner-vehicle-tracking",Me,function(e){return l.rb(0,[(e()(),l.Xa(0,0,null,null,1,"vrp-planner-vehicle-tracking",[],null,[["window","resize"]],function(e,n,t){var i=!0;return"window:resize"===n&&(i=!1!==l.hb(e,1).onResize(t)&&i),i},Ne,Pe)),l.Wa(1,4440064,null,0,Me,[Ve.a,$.a,Ae.a,Le.a,Y.a,Je.a],null,null)],function(e,n){e(n,1,0)},null)},{},{},[]),qe=t("M2Lx"),ze=t("mVsa"),He=t("4epT"),Be=t("ZYjt"),Ge=t("o3x0"),Ke=t("jQLj"),Ye=t("wmQ5"),Ze=t("4tE/"),$e=t("+dGY"),Qe=t("GW0G"),en=t("r8Is"),nn=t("t/Na"),tn=t("vARd"),ln=t("A7o+"),an=t("SN/6"),on=t("YXNw"),rn=t("lf6A"),sn=t("/VYK"),un=t("b716"),cn=t("YhbO"),dn=t("4c35"),hn=t("jlZm"),bn=t("FVSy"),pn=t("LC5p"),fn=t("0/Q6"),gn=t("de3e"),mn=t("kWGw"),vn=t("Z+uX"),_n=t("Blfk"),yn=t("8mMr"),kn=t("Lwpp"),xn=t("La40"),In=t("r43C"),Ln=t("iLfO"),Cn=t("hjRe"),wn=t("uK2o"),Tn=t("bo59"),On=t("6q6f"),Sn=t("rxZL"),Dn=t("Ps+U"),Mn=t("GSLX"),Vn=t("6w6d"),An=t("m5n6"),Jn=t("hIJP"),Pn=t("zrK0"),Rn=t("qkDU"),Wn=t("x0yz"),En=t("gUJA"),Un=function(){},Fn=t("cgBM");t.d(n,"PlannerVehicleTrackingModuleNgFactory",function(){return jn});var jn=l.Ua(i,[],function(e){return l.eb([l.fb(512,l.k,l.Ha,[[8,[a.c,o.a,r.a,s.a,s.b,u.b,u.a,c.a,d.a,h.a,b.a,p.a,f.a,g.a,m.a,v.a,_.a,Xe]],[3,l.k],l.A]),l.fb(4608,x.o,x.n,[l.x,[2,x.C]]),l.fb(4608,D.C,D.C,[]),l.fb(4608,D.f,D.f,[]),l.fb(4608,qe.c,qe.c,[]),l.fb(4608,k.d,k.d,[]),l.fb(4608,ve.c,ve.c,[ve.i,ve.e,l.k,ve.h,ve.f,l.t,l.C,x.d,C.c]),l.fb(5120,ve.j,ve.k,[ve.c]),l.fb(5120,me.b,me.c,[ve.c]),l.fb(5120,ze.b,ze.g,[ve.c]),l.fb(5120,S.a,S.b,[ve.c]),l.fb(5120,He.b,He.a,[[3,He.b]]),l.fb(4608,Be.f,k.e,[[2,k.i],[2,k.n]]),l.fb(5120,Ge.c,Ge.d,[ve.c]),l.fb(4608,Ge.e,Ge.e,[ve.c,l.t,[2,x.i],[2,Ge.b],Ge.c,[3,Ge.e],ve.e]),l.fb(4608,k.c,k.A,[[2,k.h],w.a]),l.fb(4608,Ke.i,Ke.i,[]),l.fb(5120,Ke.a,Ke.b,[ve.c]),l.fb(4608,Ye.f,Ye.f,[]),l.fb(5120,Ze.b,Ze.c,[ve.c]),l.fb(5120,$e.h,$e.b,[[3,$e.h],l.k,ve.c,l.t]),l.fb(5120,$e.i,$e.c,[[3,$e.i],$e.h]),l.fb(5120,Qe.h,Qe.b,[[3,Qe.h]]),l.fb(4608,en.e,en.e,[Ve.o]),l.fb(4608,en.f,en.f,[]),l.fb(4608,nn.j,nn.p,[x.d,l.E,nn.n]),l.fb(4608,nn.q,nn.q,[nn.j,nn.o]),l.fb(5120,nn.a,function(e){return[e]},[nn.q]),l.fb(4608,nn.m,nn.m,[]),l.fb(6144,nn.k,null,[nn.m]),l.fb(4608,nn.i,nn.i,[nn.k]),l.fb(6144,nn.b,null,[nn.i]),l.fb(4608,nn.g,nn.l,[nn.b,l.t]),l.fb(4608,nn.c,nn.c,[nn.g]),l.fb(4608,fe.a,fe.a,[nn.c,"MAP_BASE_URL"]),l.fb(4608,B.a,B.a,[Ge.e,tn.b,ln.k]),l.fb(1073742336,x.c,x.c,[]),l.fb(1073742336,D.z,D.z,[]),l.fb(1073742336,D.l,D.l,[]),l.fb(1073742336,D.w,D.w,[]),l.fb(1073742336,ln.h,ln.h,[]),l.fb(1073742336,an.a,an.a,[]),l.fb(1073742336,on.a,on.a,[]),l.fb(1073742336,an.g,an.g,[]),l.fb(1073742336,rn.b,rn.b,[]),l.fb(1073742336,an.j,an.j,[]),l.fb(1073742336,an.c,an.c,[]),l.fb(1073742336,an.f,an.f,[]),l.fb(1073742336,w.b,w.b,[]),l.fb(1073742336,sn.c,sn.c,[]),l.fb(1073742336,qe.d,qe.d,[]),l.fb(1073742336,L.e,L.e,[]),l.fb(1073742336,un.c,un.c,[]),l.fb(1073742336,cn.c,cn.c,[]),l.fb(1073742336,dn.g,dn.g,[]),l.fb(1073742336,hn.b,hn.b,[]),l.fb(1073742336,C.a,C.a,[]),l.fb(1073742336,k.n,k.n,[[2,k.f]]),l.fb(1073742336,bn.d,bn.d,[]),l.fb(1073742336,k.p,k.p,[]),l.fb(1073742336,k.z,k.z,[]),l.fb(1073742336,k.x,k.x,[]),l.fb(1073742336,pn.b,pn.b,[]),l.fb(1073742336,fn.e,fn.e,[]),l.fb(1073742336,ke.b,ke.b,[]),l.fb(1073742336,ce.a,ce.a,[]),l.fb(1073742336,M.b,M.b,[]),l.fb(1073742336,ve.g,ve.g,[]),l.fb(1073742336,me.e,me.e,[]),l.fb(1073742336,_e.c,_e.c,[]),l.fb(1073742336,ze.e,ze.e,[]),l.fb(1073742336,k.u,k.u,[]),l.fb(1073742336,S.d,S.d,[]),l.fb(1073742336,He.c,He.c,[]),l.fb(1073742336,gn.c,gn.c,[]),l.fb(1073742336,mn.c,mn.c,[]),l.fb(1073742336,Ge.k,Ge.k,[]),l.fb(1073742336,vn.c,vn.c,[]),l.fb(1073742336,_n.c,_n.c,[]),l.fb(1073742336,tn.e,tn.e,[]),l.fb(1073742336,k.B,k.B,[]),l.fb(1073742336,k.r,k.r,[]),l.fb(1073742336,Ke.j,Ke.j,[]),l.fb(1073742336,yn.b,yn.b,[]),l.fb(1073742336,kn.d,kn.d,[]),l.fb(1073742336,Ye.g,Ye.g,[]),l.fb(1073742336,xn.a,xn.a,[]),l.fb(1073742336,ue.h,ue.h,[]),l.fb(1073742336,Ze.e,Ze.e,[]),l.fb(1073742336,In.a,In.a,[]),l.fb(1073742336,$e.a,$e.a,[]),l.fb(1073742336,Ln.a,Ln.a,[]),l.fb(1073742336,Cn.a,Cn.a,[]),l.fb(1073742336,wn.a,wn.a,[]),l.fb(1073742336,Tn.a,Tn.a,[]),l.fb(1073742336,Qe.a,Qe.a,[]),l.fb(1073742336,en.a,en.a,[]),l.fb(1073742336,On.a,On.a,[]),l.fb(1073742336,nn.e,nn.e,[]),l.fb(1073742336,nn.d,nn.d,[]),l.fb(1073742336,Sn.a,Sn.a,[]),l.fb(1073742336,Dn.a,Dn.a,[]),l.fb(1073742336,Mn.a,Mn.a,[]),l.fb(1073742336,Ve.r,Ve.r,[[2,Ve.y],[2,Ve.o]]),l.fb(1073742336,Vn.a,Vn.a,[]),l.fb(1073742336,An.a,An.a,[]),l.fb(1073742336,Jn.a,Jn.a,[]),l.fb(1073742336,Pn.a,Pn.a,[]),l.fb(1073742336,A.b,A.b,[]),l.fb(1073742336,Rn.a,Rn.a,[]),l.fb(1073742336,Wn.a,Wn.a,[]),l.fb(1073742336,En.a,En.a,[]),l.fb(1073742336,Un,Un,[]),l.fb(1073742336,Fn.a,Fn.a,[]),l.fb(1073742336,i,i,[]),l.fb(256,k.g,k.k,[]),l.fb(256,nn.n,"XSRF-TOKEN",[]),l.fb(256,nn.o,"X-XSRF-TOKEN",[]),l.fb(1024,Ve.m,function(){return[[{path:"",component:Me}]]},[])])})}}]);